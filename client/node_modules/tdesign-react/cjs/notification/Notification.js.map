{"version":3,"file":"Notification.js","sources":["../../src/notification/Notification.tsx"],"sourcesContent":["import React, { forwardRef } from 'react';\nimport { CheckCircleFilledIcon, CloseIcon, InfoCircleFilledIcon } from 'tdesign-icons-react';\nimport noop from '../_util/noop';\nimport useConfig from '../_util/useConfig';\n\nimport { NotificationInstance, TdNotificationProps } from './type';\nimport { Styles } from '../common';\n\nconst blockName = 'notification';\n\nexport interface NotificationProps extends TdNotificationProps {\n  style?: Styles;\n}\n\nexport const NotificationComponent = forwardRef<any, NotificationProps>((props, ref) => {\n  const {\n    title = null,\n    content = null,\n    theme = null,\n    icon = null,\n    closeBtn,\n    footer = null,\n    duration = 3000,\n    onCloseBtnClick = noop,\n    onDurationEnd = noop,\n    style,\n  } = props;\n\n  const { classPrefix } = useConfig();\n  const prefixCls = React.useCallback(\n    (...args: (string | [string, string?, string?])[]) => {\n      let className = '';\n      args.forEach((item, index) => {\n        if (item && index > 0) className = className.concat(' ');\n        if (item instanceof Array) {\n          const [block, element, modifier] = item;\n          className = className.concat(classPrefix, '-', block);\n          if (element) className = className.concat('__', element);\n          if (modifier) className = className.concat('--', modifier);\n        } else if (typeof item === 'string') {\n          className = className.concat(classPrefix, '-', item);\n        }\n      });\n      return className;\n    },\n    [classPrefix],\n  );\n\n  React.useImperativeHandle(ref as React.Ref<NotificationInstance>, () => ({ close }), []);\n\n  /* eslint-disable react-hooks/exhaustive-deps */\n  React.useEffect(() => {\n    let timer;\n    if (duration > 0) {\n      timer = setTimeout(() => {\n        clearTimeout(timer);\n        onDurationEnd();\n      }, duration);\n    }\n    return () => {\n      if (timer) clearTimeout(timer);\n    };\n  }, []);\n\n  const renderIcon = () => {\n    const IconWrapper = ({ children }) => <div className={`${classPrefix}-notification__icon`}>{children}</div>;\n\n    // 调整优先级，icon 优先级最高\n    if (React.isValidElement(icon)) {\n      return <IconWrapper>{icon}</IconWrapper>;\n    }\n\n    if (theme && theme === 'success') {\n      return (\n        <IconWrapper>\n          <CheckCircleFilledIcon className={prefixCls('is-success')} />\n        </IconWrapper>\n      );\n    }\n    if (theme && ['info', 'warning', 'error'].indexOf(theme) >= 0) {\n      return (\n        <IconWrapper>\n          <InfoCircleFilledIcon className={prefixCls(`is-${theme}`)} />\n        </IconWrapper>\n      );\n    }\n    return null;\n  };\n\n  return (\n    <div ref={ref} className={prefixCls(blockName)} style={style}>\n      {renderIcon()}\n      <div className={prefixCls([blockName, 'main'])}>\n        <div className={prefixCls([blockName, 'title__wrap'])}>\n          <span className={prefixCls([blockName, 'title'])}>{title}</span>\n          {((): React.ReactNode => {\n            if (typeof closeBtn === 'boolean' && closeBtn) {\n              return (\n                <CloseIcon\n                  className={prefixCls('icon-close')}\n                  onClick={(e) => {\n                    onCloseBtnClick({ e });\n                  }}\n                />\n              );\n            }\n            if (React.isValidElement(closeBtn)) {\n              return (\n                <div\n                  onClick={(e) => {\n                    onCloseBtnClick({ e });\n                  }}\n                >\n                  {closeBtn}\n                </div>\n              );\n            }\n            return null;\n          })()}\n        </div>\n        {((): React.ReactNode => {\n          if (typeof content === 'string') {\n            return <div className={prefixCls([blockName, 'content'])}>{content}</div>;\n          }\n          if (React.isValidElement(content)) return content;\n          return null;\n        })()}\n        {React.isValidElement(footer) && <div className={prefixCls([blockName, 'detail'])}>{footer}</div>}\n        {typeof footer === 'function' && <div className={prefixCls([blockName, 'detail'])}>{footer()}</div>}\n      </div>\n    </div>\n  );\n});\n\nexport default NotificationComponent;\n"],"names":["blockName","NotificationComponent","forwardRef","props","ref","title","content","theme","icon","closeBtn","footer","duration","onCloseBtnClick","noop","onDurationEnd","style","useConfig","classPrefix","prefixCls","React","useCallback","className","args","forEach","item","index","concat","Array","block","element","modifier","useImperativeHandle","close","useEffect","timer","setTimeout","clearTimeout","renderIcon","IconWrapper","children","createElement","isValidElement","CheckCircleFilledIcon","indexOf","InfoCircleFilledIcon","CloseIcon","onClick","e"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAIA,IAAMA,SAAS,GAAG,cAAlB;IACaC,qBAAqB,gBAAGC,gBAAU,CAAC,UAACC,KAAD,EAAQC,GAAR,EAAgB;AAC9D,qBAWID,KAXJ,CACEE,KADF;AAAA,MACEA,KADF,6BACU,IADV;AAAA,uBAWIF,KAXJ,CAEEG,OAFF;AAAA,MAEEA,OAFF,+BAEY,IAFZ;AAAA,qBAWIH,KAXJ,CAGEI,KAHF;AAAA,MAGEA,KAHF,6BAGU,IAHV;AAAA,oBAWIJ,KAXJ,CAIEK,IAJF;AAAA,MAIEA,IAJF,4BAIS,IAJT;AAAA,MAKEC,QALF,GAWIN,KAXJ,CAKEM,QALF;AAAA,sBAWIN,KAXJ,CAMEO,MANF;AAAA,MAMEA,MANF,8BAMW,IANX;AAAA,wBAWIP,KAXJ,CAOEQ,QAPF;AAAA,MAOEA,QAPF,gCAOa,GAPb;AAAA,8BAWIR,KAXJ,CAQES,eARF;AAAA,MAQEA,eARF,sCAQoBC,qBARpB;AAAA,6BAWIV,KAXJ,CASEW,aATF;AAAA,MASEA,aATF,qCASkBD,qBATlB;AAAA,MAUEE,KAVF,GAWIZ,KAXJ,CAUEY,KAVF;;AAYA,mBAAwBC,0BAAS,EAAjC;AAAA,MAAQC,WAAR,cAAQA,WAAR;;AACA,MAAMC,SAAS,GAAGC,yBAAK,CAACC,WAAN,CAAkB,YAAa;AAC/C,QAAIC,SAAS,GAAG,EAAhB;;AAD+C,sCAATC,IAAS;AAATA,MAAAA,IAAS;AAAA;;AAE/CA,IAAAA,IAAI,CAACC,OAAL,CAAa,UAACC,IAAD,EAAOC,KAAP,EAAiB;AAC5B,UAAID,IAAI,IAAIC,KAAK,GAAG,CAApB,EACEJ,SAAS,GAAGA,SAAS,CAACK,MAAV,CAAiB,GAAjB,CAAZ;;AACF,UAAIF,IAAI,YAAYG,KAApB,EAA2B;AACzB,iDAAmCH,IAAnC;AAAA,YAAOI,KAAP;AAAA,YAAcC,OAAd;AAAA,YAAuBC,QAAvB;;AACAT,QAAAA,SAAS,GAAGA,SAAS,CAACK,MAAV,CAAiBT,WAAjB,EAA8B,GAA9B,EAAmCW,KAAnC,CAAZ;AACA,YAAIC,OAAJ,EACER,SAAS,GAAGA,SAAS,CAACK,MAAV,CAAiB,IAAjB,EAAuBG,OAAvB,CAAZ;AACF,YAAIC,QAAJ,EACET,SAAS,GAAGA,SAAS,CAACK,MAAV,CAAiB,IAAjB,EAAuBI,QAAvB,CAAZ;AACH,OAPD,MAOO,IAAI,OAAON,IAAP,KAAgB,QAApB,EAA8B;AACnCH,QAAAA,SAAS,GAAGA,SAAS,CAACK,MAAV,CAAiBT,WAAjB,EAA8B,GAA9B,EAAmCO,IAAnC,CAAZ;AACD;AACF,KAbD;AAcA,WAAOH,SAAP;AACD,GAjBiB,EAiBf,CAACJ,WAAD,CAjBe,CAAlB;AAkBAE,EAAAA,yBAAK,CAACY,mBAAN,CAA0B3B,GAA1B,EAA+B;AAAA,WAAO;AAAE4B,MAAAA,KAAK,EAALA;AAAF,KAAP;AAAA,GAA/B,EAAkD,EAAlD;AACAb,EAAAA,yBAAK,CAACc,SAAN,CAAgB,YAAM;AACpB,QAAIC,KAAJ;;AACA,QAAIvB,QAAQ,GAAG,CAAf,EAAkB;AAChBuB,MAAAA,KAAK,GAAGC,UAAU,CAAC,YAAM;AACvBC,QAAAA,YAAY,CAACF,KAAD,CAAZ;AACApB,QAAAA,aAAa;AACd,OAHiB,EAGfH,QAHe,CAAlB;AAID;;AACD,WAAO,YAAM;AACX,UAAIuB,KAAJ,EACEE,YAAY,CAACF,KAAD,CAAZ;AACH,KAHD;AAID,GAZD,EAYG,EAZH;;AAaA,MAAMG,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB,QAAMC,WAAW,GAAG,SAAdA,WAAc;AAAA,UAAGC,QAAH,QAAGA,QAAH;AAAA,4BAAkCpB,yBAAK,CAACqB,aAAN,CAAoB,KAApB,EAA2B;AAC/EnB,QAAAA,SAAS,YAAKJ,WAAL;AADsE,OAA3B,EAEnDsB,QAFmD,CAAlC;AAAA,KAApB;;AAGA,sBAAIpB,yBAAK,CAACsB,cAAN,CAAqBjC,IAArB,CAAJ,EAAgC;AAC9B,4BAAuBW,yBAAK,CAACqB,aAAN,CAAoBF,WAApB,EAAiC,IAAjC,EAAuC9B,IAAvC,CAAvB;AACD;;AACD,QAAID,KAAK,IAAIA,KAAK,KAAK,SAAvB,EAAkC;AAChC,4BAAuBY,yBAAK,CAACqB,aAAN,CAAoBF,WAApB,EAAiC,IAAjC,iBAAuDnB,yBAAK,CAACqB,aAAN,CAAoBE,uCAApB,EAA2C;AACvHrB,QAAAA,SAAS,EAAEH,SAAS,CAAC,YAAD;AADmG,OAA3C,CAAvD,CAAvB;AAGD;;AACD,QAAIX,KAAK,IAAI,CAAC,MAAD,EAAS,SAAT,EAAoB,OAApB,EAA6BoC,OAA7B,CAAqCpC,KAArC,KAA+C,CAA5D,EAA+D;AAC7D,4BAAuBY,yBAAK,CAACqB,aAAN,CAAoBF,WAApB,EAAiC,IAAjC,iBAAuDnB,yBAAK,CAACqB,aAAN,CAAoBI,sCAApB,EAA0C;AACtHvB,QAAAA,SAAS,EAAEH,SAAS,cAAOX,KAAP;AADkG,OAA1C,CAAvD,CAAvB;AAGD;;AACD,WAAO,IAAP;AACD,GAlBD;;AAmBA,wBAAuBY,yBAAK,CAACqB,aAAN,CAAoB,KAApB,EAA2B;AAChDpC,IAAAA,GAAG,EAAHA,GADgD;AAEhDiB,IAAAA,SAAS,EAAEH,SAAS,CAAClB,SAAD,CAF4B;AAGhDe,IAAAA,KAAK,EAALA;AAHgD,GAA3B,EAIpBsB,UAAU,EAJU,iBAIUlB,yBAAK,CAACqB,aAAN,CAAoB,KAApB,EAA2B;AAC1DnB,IAAAA,SAAS,EAAEH,SAAS,CAAC,CAAClB,SAAD,EAAY,MAAZ,CAAD;AADsC,GAA3B,iBAEdmB,yBAAK,CAACqB,aAAN,CAAoB,KAApB,EAA2B;AAC5CnB,IAAAA,SAAS,EAAEH,SAAS,CAAC,CAAClB,SAAD,EAAY,aAAZ,CAAD;AADwB,GAA3B,iBAEAmB,yBAAK,CAACqB,aAAN,CAAoB,MAApB,EAA4B;AAC7CnB,IAAAA,SAAS,EAAEH,SAAS,CAAC,CAAClB,SAAD,EAAY,OAAZ,CAAD;AADyB,GAA5B,EAEhBK,KAFgB,CAFA,EAIP,YAAM;AAChB,QAAI,OAAOI,QAAP,KAAoB,SAApB,IAAiCA,QAArC,EAA+C;AAC7C,4BAAuBU,yBAAK,CAACqB,aAAN,CAAoBK,2BAApB,EAA+B;AACpDxB,QAAAA,SAAS,EAAEH,SAAS,CAAC,YAAD,CADgC;AAEpD4B,QAAAA,OAAO,EAAE,iBAACC,CAAD,EAAO;AACdnC,UAAAA,eAAe,CAAC;AAAEmC,YAAAA,CAAC,EAADA;AAAF,WAAD,CAAf;AACD;AAJmD,OAA/B,CAAvB;AAMD;;AACD,sBAAI5B,yBAAK,CAACsB,cAAN,CAAqBhC,QAArB,CAAJ,EAAoC;AAClC,4BAAuBU,yBAAK,CAACqB,aAAN,CAAoB,KAApB,EAA2B;AAChDM,QAAAA,OAAO,EAAE,iBAACC,CAAD,EAAO;AACdnC,UAAAA,eAAe,CAAC;AAAEmC,YAAAA,CAAC,EAADA;AAAF,WAAD,CAAf;AACD;AAH+C,OAA3B,EAIpBtC,QAJoB,CAAvB;AAKD;;AACD,WAAO,IAAP;AACD,GAjBU,EAJQ,CAFc,EAuBzB,YAAM;AACZ,QAAI,OAAOH,OAAP,KAAmB,QAAvB,EAAiC;AAC/B,4BAAuBa,yBAAK,CAACqB,aAAN,CAAoB,KAApB,EAA2B;AAChDnB,QAAAA,SAAS,EAAEH,SAAS,CAAC,CAAClB,SAAD,EAAY,SAAZ,CAAD;AAD4B,OAA3B,EAEpBM,OAFoB,CAAvB;AAGD;;AACD,sBAAIa,yBAAK,CAACsB,cAAN,CAAqBnC,OAArB,CAAJ,EACE,OAAOA,OAAP;AACF,WAAO,IAAP;AACD,GATM,EAvB0B,eAgC3Ba,yBAAK,CAACsB,cAAN,CAAqB/B,MAArB,oBAAgDS,yBAAK,CAACqB,aAAN,CAAoB,KAApB,EAA2B;AAC/EnB,IAAAA,SAAS,EAAEH,SAAS,CAAC,CAAClB,SAAD,EAAY,QAAZ,CAAD;AAD2D,GAA3B,EAEnDU,MAFmD,CAhCrB,EAkCrB,OAAOA,MAAP,KAAkB,UAAlB,mBAAgDS,yBAAK,CAACqB,aAAN,CAAoB,KAApB,EAA2B;AACrFnB,IAAAA,SAAS,EAAEH,SAAS,CAAC,CAAClB,SAAD,EAAY,QAAZ,CAAD;AADiE,GAA3B,EAEzDU,MAAM,EAFmD,CAlC3B,CAJV,CAAvB;AAyCD,CA1G8C;;;;;"}