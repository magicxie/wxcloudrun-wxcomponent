{"version":3,"file":"NotificationPlugin.js","sources":["../../src/notification/NotificationPlugin.ts"],"sourcesContent":["import { fetchListInstance, listMap } from './NotificationList';\nimport {\n  NotificationCloseAllMethod,\n  NotificationCloseMethod,\n  NotificationErrorMethod,\n  NotificationInfoMethod,\n  NotificationInfoOptions,\n  NotificationInstance,\n  NotificationOptions,\n  NotificationPlacementList,\n  NotificationSuccessMethod,\n  NotificationThemeList,\n  NotificationWarningMethod,\n} from './type';\n\n// 扩展接口声明的结构，用户使用时可得到 .info 的 ts 提示\ninterface Notification {\n  (theme: NotificationThemeList, options: NotificationOptions): Promise<NotificationInstance>;\n  info: NotificationInfoMethod;\n  success: NotificationSuccessMethod;\n  warning: NotificationWarningMethod;\n  error: NotificationErrorMethod;\n  closeAll: NotificationCloseAllMethod;\n  close: NotificationCloseMethod;\n}\n\n/**\n * @desc 函数调用时的渲染函数\n * @param theme 主题类型\n * @param options 通知的参数\n */\nconst renderNotification = (theme: NotificationThemeList, options: NotificationInfoOptions) => {\n  if (typeof options !== 'object') return;\n\n  const placement: NotificationPlacementList = (() => {\n    if (['top-left', 'top-right', 'bottom-left', 'bottom-right'].indexOf(options.placement) >= 0) {\n      return options.placement;\n    }\n    return 'top-right';\n  })();\n\n  const attach: HTMLElement = (() => {\n    if (options.attach && typeof options.attach === 'string') {\n      const element: Element = document.querySelector(options.attach);\n      if (element instanceof HTMLElement) return element;\n    }\n\n    if (options.attach instanceof HTMLElement) return options.attach;\n\n    const containerId = `tdesign-notification-${placement}`;\n    const container = document.querySelector(`#${containerId}`);\n    if (container && container instanceof HTMLElement) {\n      return container;\n    }\n\n    const element: HTMLDivElement = document.createElement('div');\n    element.setAttribute('id', containerId);\n    document.body.appendChild(element);\n    return element;\n  })();\n\n  const zIndex = options.zIndex || 6000;\n\n  return fetchListInstance(placement, attach, zIndex).then((listInstance) => listInstance.push(theme, options));\n};\n\nexport const NotificationPlugin: Notification = (theme, props) => renderNotification(theme, props);\nNotificationPlugin.info = (options) => renderNotification('info', options);\nNotificationPlugin.success = (options) => renderNotification('success', options);\nNotificationPlugin.warning = (options) => renderNotification('warning', options);\nNotificationPlugin.error = (options) => renderNotification('error', options);\nNotificationPlugin.close = (promise) => promise.then((instance) => instance.close());\nNotificationPlugin.closeAll = () => listMap.forEach((list) => list.removeAll());\n\nexport const notification = NotificationPlugin;\n"],"names":["renderNotification","theme","options","_typeof","placement","indexOf","attach","element2","document","querySelector","HTMLElement","containerId","container","element","createElement","setAttribute","body","appendChild","zIndex","fetchListInstance","then","listInstance","push","NotificationPlugin","props","info","success","warning","error","close","promise","instance","closeAll","listMap","forEach","list","removeAll","notification"],"mappings":"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"}