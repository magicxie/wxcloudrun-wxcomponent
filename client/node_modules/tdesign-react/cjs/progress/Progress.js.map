{"version":3,"file":"Progress.js","sources":["../../src/progress/Progress.tsx"],"sourcesContent":["import React, { forwardRef } from 'react';\nimport classNames from 'classnames';\nimport {\n  CheckCircleIcon,\n  CloseCircleIcon,\n  ErrorCircleIcon,\n  CheckCircleFilledIcon,\n  CloseCircleFilledIcon,\n  ErrorCircleFilledIcon,\n} from 'tdesign-icons-react';\nimport useConfig from '../_util/useConfig';\nimport getBackgroundColor from '../_util/linearGradient';\nimport { StyledProps } from '../common';\nimport { TdProgressProps } from './type';\n\nexport interface ProgressProps extends TdProgressProps, StyledProps {}\n/**\n * 按钮组件\n */\nconst Progress = forwardRef((props: ProgressProps, ref: React.Ref<HTMLDivElement>) => {\n  const {\n    theme = 'line',\n    percentage = 0,\n    label = true,\n    color = '',\n    trackColor = '#f5f5f5',\n    strokeWidth,\n    size = 'medium',\n    className,\n  } = props;\n  let { status } = props;\n  if (!status && percentage >= 100) {\n    status = 'success';\n  }\n  let iconMap = {\n    success: CheckCircleFilledIcon,\n    error: CloseCircleFilledIcon,\n    warning: ErrorCircleFilledIcon,\n  };\n  const { classPrefix } = useConfig();\n  // 进度条展示内容\n  const getInfoContent = () => {\n    if (!label) {\n      return '';\n    }\n    let info: React.ReactNode;\n    // 为布尔值，默认百分百展示，否则之间展示label内容\n    if (typeof label === 'boolean') {\n      info = <div className={`${classPrefix}-progress__info`}>{`${percentage}%`}</div>;\n      if (['success', 'error', 'warning'].includes(status)) {\n        const Icon = iconMap[status];\n        info = (\n          <div className={`${classPrefix}-progress__info`}>\n            <Icon className={`${classPrefix}-progress__icon`} />\n          </div>\n        );\n      }\n    } else {\n      info = <div className={`${classPrefix}-progress__info`}>{label}</div>;\n    }\n    return info;\n  };\n  const statusClassName = `${classPrefix}-progress--status--${status}`;\n  let progressDom;\n  if (theme === 'circle') {\n    iconMap = {\n      success: CheckCircleIcon,\n      error: CloseCircleIcon,\n      warning: ErrorCircleIcon,\n    };\n    // 获取直径\n    const getDiameter = (): number => {\n      let diameter = 112;\n      if (!size) {\n        return diameter;\n      }\n      switch (size) {\n        default:\n          diameter = Number(size);\n          break;\n        case 'small':\n          diameter = 72;\n          break;\n        case 'medium':\n          diameter = 112;\n          break;\n        case 'large':\n          diameter = 160;\n          break;\n      }\n      return diameter;\n    };\n    // 获取环形进度条 环的宽度\n    const getCircleStokeWidth = (): number => {\n      if (!strokeWidth) {\n        if (size === 'small') {\n          return 4;\n        }\n      }\n      if (typeof strokeWidth !== 'number' || Number.isNaN(strokeWidth)) {\n        return 6;\n      }\n      return strokeWidth;\n    };\n    // 环形进度条尺寸(进度条占位空间，长宽占位)\n    const circleStokeWidth = getCircleStokeWidth();\n    // 直径\n    const diameter = getDiameter();\n    // 半径\n    const radius = diameter / 2;\n    // 内环半径\n    const innerRadius = radius - circleStokeWidth;\n\n    const perimeter = Math.PI * 2 * radius;\n    const percent = percentage / 100;\n    const strokeDasharray = `${perimeter * percent}  ${perimeter * (1 - percent)}`;\n    // 自适应文字，根据半路，适度调整\n    const fontSizeRatio = innerRadius * 0.27;\n    const circleBoxStyle = {\n      width: diameter,\n      height: diameter,\n      fontSize: 4 + fontSizeRatio,\n    } as React.CSSProperties;\n    const circlePathStyle = {\n      stroke: color,\n      strokeLinecap: circleStokeWidth < 30 ? 'round' : 'buff',\n    } as React.CSSProperties;\n    const circleCenterInViewBox = radius + circleStokeWidth / 2;\n    progressDom = (\n      <div\n        ref={ref}\n        className={classNames(`${classPrefix}-progress--circle`, {\n          [`${statusClassName}`]: status,\n        })}\n        style={circleBoxStyle}\n      >\n        {getInfoContent()}\n        <svg\n          width={diameter}\n          height={diameter}\n          viewBox={`0 0 ${diameter + circleStokeWidth} ${diameter + circleStokeWidth}`}\n        >\n          <circle\n            cx={circleCenterInViewBox}\n            cy={circleCenterInViewBox}\n            r={radius}\n            strokeWidth={circleStokeWidth}\n            stroke={trackColor}\n            fill=\"none\"\n          ></circle>\n          <circle\n            cx={circleCenterInViewBox}\n            cy={circleCenterInViewBox}\n            r={radius}\n            strokeWidth={circleStokeWidth}\n            fill=\"none\"\n            transform={`matrix(0,-1,1,0,0,${diameter + circleStokeWidth})`}\n            strokeDasharray={strokeDasharray}\n            className={`${classPrefix}-progress__circle-inner`}\n            style={circlePathStyle}\n          ></circle>\n        </svg>\n      </div>\n    );\n    return <div className={className}>{progressDom}</div>;\n  }\n  // 进度条轨道高度\n  const getHeight = (): string => {\n    if (strokeWidth) {\n      return typeof strokeWidth === 'string' ? strokeWidth : `${strokeWidth}px`;\n    }\n  };\n  const trackStyle = {\n    height: getHeight(),\n    backgroundColor: trackColor,\n    borderRadius: getHeight(),\n  } as React.CSSProperties;\n  const barStyle = {\n    width: `${percentage}%`,\n    background: getBackgroundColor(color),\n    borderRadius: getHeight(),\n  } as React.CSSProperties;\n  if (theme === 'plump') {\n    const PLUMP_SEPERATE = 10;\n    progressDom = (\n      <div\n        ref={ref}\n        className={classNames(`${classPrefix}-progress__bar`, `${classPrefix}-progress--plump`, {\n          [`${statusClassName}`]: status,\n          [`${classPrefix}-progress--over-ten`]: percentage > PLUMP_SEPERATE,\n          [`${classPrefix}-progress--under-ten`]: percentage <= PLUMP_SEPERATE,\n        })}\n        style={trackStyle}\n      >\n        <div className={`${classPrefix}-progress__inner`} style={barStyle}>\n          {label && (\n            <div\n              className={`${classPrefix}-progress__info`}\n              style={percentage > 10 ? { color: '#fff' } : { right: '-2.5em' }}\n            >{`${percentage}%`}</div>\n          )}\n        </div>\n      </div>\n    );\n  } else {\n    progressDom = (\n      <div\n        ref={ref}\n        className={classNames(`${classPrefix}-progress--thin`, {\n          [`${statusClassName}`]: status,\n        })}\n      >\n        <div className={`${classPrefix}-progress__bar`} style={trackStyle}>\n          <div className={`${classPrefix}-progress__inner`} style={barStyle}></div>\n        </div>\n        {getInfoContent()}\n      </div>\n    );\n  }\n  return <div className={className}>{progressDom}</div>;\n});\n\nProgress.displayName = 'Progress';\n\nexport default Progress;\n"],"names":["Progress","forwardRef","props","ref","theme","percentage","label","color","trackColor","strokeWidth","size","className","status","iconMap","success","CheckCircleFilledIcon","error","CloseCircleFilledIcon","warning","ErrorCircleFilledIcon","useConfig","classPrefix","getInfoContent","info","React","createElement","includes","Icon","statusClassName","progressDom","CheckCircleIcon","CloseCircleIcon","ErrorCircleIcon","getDiameter","diameter2","Number","getCircleStokeWidth","isNaN","circleStokeWidth","diameter","radius","innerRadius","perimeter","Math","PI","percent","strokeDasharray","fontSizeRatio","circleBoxStyle","width","height","fontSize","circlePathStyle","stroke","strokeLinecap","circleCenterInViewBox","classNames","style","viewBox","cx","cy","r","fill","transform","getHeight","trackStyle","backgroundColor","borderRadius","barStyle","background","getBackgroundColor","PLUMP_SEPERATE","right","displayName"],"mappings":"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"}