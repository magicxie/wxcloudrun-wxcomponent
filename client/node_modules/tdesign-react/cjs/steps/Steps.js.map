{"version":3,"file":"Steps.js","sources":["../../src/steps/Steps.tsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport classnames from 'classnames';\nimport useConfig from '../_util/useConfig';\nimport { TdStepsProps } from './type';\nimport { StyledProps } from '../common';\nimport StepItem from './StepItem';\nimport StepsContext from './StepsContext';\n\nexport interface StepsProps extends TdStepsProps, StyledProps {\n  children?: React.ReactNode;\n}\n\n/**\n * 步骤条组件\n * @param props\n */\nfunction Steps(props: StepsProps) {\n  const {\n    style,\n    current = 0,\n    layout = 'horizontal',\n    theme = 'default',\n    sequence = 'positive',\n    children,\n    onChange,\n    options = [],\n  } = props;\n  const { classPrefix } = useConfig();\n\n  const className = classnames({\n    [`${classPrefix}-steps`]: true,\n    [`${classPrefix}-steps--horizontal`]: layout === 'horizontal',\n    [`${classPrefix}-steps--vertical`]: layout === 'vertical',\n    [`${classPrefix}-steps--default-anchor`]: theme === 'default',\n    [`${classPrefix}-steps--positive`]: sequence === 'positive',\n    [`${classPrefix}-steps--reverse`]: sequence === 'reverse',\n    [`${classPrefix}-steps--dot-anchor`]: theme === 'dot',\n    [props.className]: !!props.className,\n  });\n\n  const previousRef = useRef<number | string>(current);\n\n  // 监听步骤变化\n  useEffect(() => {\n    const previous = previousRef.current;\n    if (previous !== current && onChange) {\n      onChange(current, previous);\n    }\n  }, [current, onChange]);\n\n  const shouldReserve = sequence === 'reverse' && layout === 'vertical';\n\n  // 处理 children 的展示逻辑，生成展示列表供页面循环;\n  const childrenList = React.Children.toArray(children);\n  const childrenDisplayList = shouldReserve ? childrenList.reverse() : childrenList;\n\n  // 处理 options\n  const optionsDisplayList = shouldReserve ? options.reverse() : options;\n\n  // children 优先\n  let stepItemList = null;\n  if (childrenList.length !== 0) {\n    stepItemList = childrenDisplayList.map((child: JSX.Element, index: number) =>\n      React.cloneElement(child, { value: index, ...child.props }),\n    );\n  } else {\n    stepItemList = optionsDisplayList.map((v, index) => <StepItem {...v} value={index} key={index} />);\n  }\n\n  return (\n    <StepsContext.Provider value={{ current, theme }}>\n      <div className={className} style={style}>\n        {stepItemList}\n      </div>\n    </StepsContext.Provider>\n  );\n}\n\nSteps.StepItem = StepItem;\nSteps.displayName = 'Steps';\n\nexport default Steps;\n"],"names":["Steps","props","style","current","layout","theme","sequence","children","onChange","options","useConfig","classPrefix","className","classnames","previousRef","useRef","useEffect","previous","shouldReserve","childrenList","React","Children","toArray","childrenDisplayList","reverse","optionsDisplayList","stepItemList","length","map","child","index","cloneElement","value","v","createElement","StepItem","key","StepsContext","Provider","displayName"],"mappings":"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"}