{"version":3,"file":"Switch.js","sources":["../../src/switch/Switch.tsx"],"sourcesContent":["import React, { forwardRef, useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport Loading from '../loading';\nimport useConfig from '../_util/useConfig';\nimport { StyledProps } from '../common';\nimport useCommonClassName from '../_util/useCommonClassName';\nimport { TdSwitchProps } from './type';\n\nexport type SwitchChangeEventHandler = (value: boolean, event: React.MouseEvent<HTMLButtonElement>) => void;\nexport type SwitchClickEventHandler = SwitchChangeEventHandler;\n\nexport interface SwitchProps extends TdSwitchProps, StyledProps {}\n\nconst Switch = forwardRef<HTMLButtonElement, SwitchProps>(\n  ({ className, value, defaultValue, disabled, loading, size, label, customValue, onChange, ...restProps }, ref) => {\n    const { classPrefix } = useConfig();\n    const [activeValue = true, inactiveValue = false] = customValue || [];\n\n    const isControlled = typeof value !== 'undefined';\n    const initChecked = defaultValue === activeValue || value === activeValue;\n    const [innerChecked, setInnerChecked] = useState(initChecked);\n\n    function renderContent(checked) {\n      if (typeof label === 'function') return label({ value });\n\n      if (typeof label === 'string') return label;\n\n      if (Array.isArray(label)) {\n        const [activeContent = '', inactiveContent = ''] = label;\n        const content = checked ? activeContent : inactiveContent;\n\n        if (typeof content === 'function') return content();\n\n        return content;\n      }\n\n      return null;\n    }\n\n    function onInternalClick() {\n      if (disabled) return;\n\n      !isControlled && setInnerChecked(!innerChecked);\n\n      const changedValue = !innerChecked ? activeValue : inactiveValue;\n      onChange?.(changedValue);\n    }\n\n    useEffect(() => {\n      if (Array.isArray(customValue) && !customValue.includes(value)) {\n        throw `value is not in customValue: ${JSON.stringify(customValue)}`;\n      }\n      isControlled && setInnerChecked(value === activeValue);\n    }, [value, customValue, activeValue, isControlled]);\n\n    const { SIZE, STATUS } = useCommonClassName();\n    const switchClassName = classNames(\n      `${classPrefix}-switch`,\n      className,\n      {\n        [STATUS.checked]: innerChecked,\n        [STATUS.disabled]: disabled,\n        [STATUS.loading]: loading,\n      },\n      SIZE[size],\n    );\n\n    return (\n      <button\n        {...restProps}\n        type=\"button\"\n        role=\"switch\"\n        disabled={disabled || loading}\n        className={switchClassName}\n        ref={ref}\n        onClick={onInternalClick}\n      >\n        <span className={`${classPrefix}-switch__handle`}>{loading && <Loading loading={true} size=\"small\" />}</span>\n        <div className={`${classPrefix}-switch__content`}>{renderContent(innerChecked)}</div>\n      </button>\n    );\n  },\n);\n\nSwitch.displayName = 'Switch';\n\nexport default Switch;\n"],"names":["Switch","forwardRef","ref","className","value","defaultValue","disabled","loading","size","label","customValue","onChange","restProps","useConfig","classPrefix","activeValue","inactiveValue","isControlled","initChecked","useState","innerChecked","setInnerChecked","renderContent","checked","Array","isArray","activeContent","inactiveContent","content","onInternalClick","changedValue","useEffect","includes","JSON","stringify","useCommonClassName","SIZE","STATUS","switchClassName","classNames","React","createElement","type","role","onClick","Loading","displayName"],"mappings":"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"}