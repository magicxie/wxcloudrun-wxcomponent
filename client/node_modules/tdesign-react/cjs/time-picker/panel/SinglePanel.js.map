{"version":3,"file":"SinglePanel.js","sources":["../../../node_modules/lodash/_baseRange.js","../../../node_modules/lodash/_createRange.js","../../../node_modules/lodash/range.js","../../../src/time-picker/panel/SinglePanel.tsx"],"sourcesContent":["/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeCeil = Math.ceil,\n    nativeMax = Math.max;\n\n/**\n * The base implementation of `_.range` and `_.rangeRight` which doesn't\n * coerce arguments.\n *\n * @private\n * @param {number} start The start of the range.\n * @param {number} end The end of the range.\n * @param {number} step The value to increment or decrement by.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Array} Returns the range of numbers.\n */\nfunction baseRange(start, end, step, fromRight) {\n  var index = -1,\n      length = nativeMax(nativeCeil((end - start) / (step || 1)), 0),\n      result = Array(length);\n\n  while (length--) {\n    result[fromRight ? length : ++index] = start;\n    start += step;\n  }\n  return result;\n}\n\nmodule.exports = baseRange;\n","var baseRange = require('./_baseRange'),\n    isIterateeCall = require('./_isIterateeCall'),\n    toFinite = require('./toFinite');\n\n/**\n * Creates a `_.range` or `_.rangeRight` function.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new range function.\n */\nfunction createRange(fromRight) {\n  return function(start, end, step) {\n    if (step && typeof step != 'number' && isIterateeCall(start, end, step)) {\n      end = step = undefined;\n    }\n    // Ensure the sign of `-0` is preserved.\n    start = toFinite(start);\n    if (end === undefined) {\n      end = start;\n      start = 0;\n    } else {\n      end = toFinite(end);\n    }\n    step = step === undefined ? (start < end ? 1 : -1) : toFinite(step);\n    return baseRange(start, end, step, fromRight);\n  };\n}\n\nmodule.exports = createRange;\n","var createRange = require('./_createRange');\n\n/**\n * Creates an array of numbers (positive and/or negative) progressing from\n * `start` up to, but not including, `end`. A step of `-1` is used if a negative\n * `start` is specified without an `end` or `step`. If `end` is not specified,\n * it's set to `start` with `start` then set to `0`.\n *\n * **Note:** JavaScript follows the IEEE-754 standard for resolving\n * floating-point values which can produce unexpected results.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {number} [start=0] The start of the range.\n * @param {number} end The end of the range.\n * @param {number} [step=1] The value to increment or decrement by.\n * @returns {Array} Returns the range of numbers.\n * @see _.inRange, _.rangeRight\n * @example\n *\n * _.range(4);\n * // => [0, 1, 2, 3]\n *\n * _.range(-4);\n * // => [0, -1, -2, -3]\n *\n * _.range(1, 5);\n * // => [1, 2, 3, 4]\n *\n * _.range(0, 20, 5);\n * // => [0, 5, 10, 15]\n *\n * _.range(0, -4, -1);\n * // => [0, -1, -2, -3]\n *\n * _.range(1, 4, 0);\n * // => [1, 1, 1]\n *\n * _.range(0);\n * // => []\n */\nvar range = createRange();\n\nmodule.exports = range;\n","import React, { FC, useCallback, useEffect, useState, useRef, useMemo } from 'react';\nimport classNames from 'classnames';\nimport dayjs from 'dayjs';\nimport debounce from 'lodash/debounce';\nimport padStart from 'lodash/padStart';\nimport range from 'lodash/range';\n\nimport useConfig from '../../_util/useConfig';\nimport noop from '../../_util/noop';\n\nimport { TdTimePickerProps } from '../type';\nimport { EPickerCols } from '../interfaces';\n\nimport { MERIDIEM_LIST, AM, PM, useTimePickerTextConfig } from '../consts';\n\nconst timeArr = [EPickerCols.hour, EPickerCols.minute, EPickerCols.second];\n\nexport type SinglePanelProps = Pick<\n  TdTimePickerProps,\n  'steps' | 'format' | 'disableTime' | 'value' | 'hideDisabledTime' | 'onChange'\n>;\n\nconst SinglePanel: FC<SinglePanelProps> = (props) => {\n  const { steps, format, onChange = noop, value, hideDisabledTime = true, disableTime } = props;\n  const { classPrefix } = useConfig();\n  const TEXT_CONFIG = useTimePickerTextConfig();\n\n  const panelClassName = `${classPrefix}-time-picker__panel`;\n\n  const [cols, setCols] = useState<Array<EPickerCols>>([]);\n  const colsRef = useRef([]);\n  const maskRef = useRef(null);\n\n  const dayjsValue = useMemo(() => {\n    const isStepsSet = !!steps.filter((v) => v > 1).length;\n\n    if (value) {\n      return dayjs(value, format);\n    }\n    if (isStepsSet) {\n      return dayjs().hour(0).minute(0).second(0);\n    }\n    return dayjs();\n  }, [value, format, steps]);\n\n  useEffect(() => {\n    colsRef.current = colsRef.current.slice(0, cols.length);\n  }, [cols]);\n\n  useEffect(() => {\n    const match = format.match(/(a\\s+|A\\s+)?(h+|H+)?:?(m+)?:?(s+)?(\\s+a|\\s+A)?/);\n    const [, startCol, hourCol, minuteCol, secondCol, endCol] = match;\n    const { meridiem, hour, minute, second } = EPickerCols;\n\n    const renderCol = [\n      startCol && meridiem,\n      hourCol && hour,\n      minuteCol && minute,\n      secondCol && second,\n      endCol && meridiem,\n    ].filter((v) => !!v);\n\n    setCols(renderCol);\n  }, [format]);\n\n  // 获取每个时间的高度\n  const getItemHeight = useCallback(() => {\n    const maskDom = maskRef?.current?.querySelector('div');\n    const timeItemTotalHeight = maskDom.offsetHeight + parseInt(getComputedStyle(maskDom).marginTop, 10);\n    return timeItemTotalHeight;\n  }, []);\n\n  const closestLookup = (availableArr: Array<any>, calcVal: number, step: number) => {\n    if (step <= 1) return calcVal;\n    return availableArr.sort((a, b) => Math.abs(calcVal + 1 - a) - Math.abs(calcVal + 1 - b))[0];\n  };\n\n  const timeItemCanUsed = (col: EPickerCols, el: string | number) => {\n    const colIdx = timeArr.indexOf(col);\n    if (colIdx !== -1) {\n      const params: [number, number, number] = [dayjsValue.hour(), dayjsValue.minute(), dayjsValue.second()];\n      params[colIdx] = el as number;\n      return !(disableTime && disableTime?.(...params));\n    }\n    return true;\n  };\n\n  // 获取需要渲染的column\n  const getColList = useCallback(\n    (col: EPickerCols) => {\n      let count = 0;\n\n      if (timeArr.includes(col)) {\n        // hour/minute/second column scroller render\n        const colIdx = timeArr.indexOf(col);\n        const colStep = steps[colIdx];\n\n        if (col === EPickerCols.hour) {\n          count = /[h]{1}/.test(format) ? 11 : 23;\n        } else {\n          count = 59;\n        }\n\n        const colList = range(0, count + 1, Number(colStep)).map((v) => padStart(String(v), 2, '0')) || [];\n\n        return hideDisabledTime && !!disableTime\n          ? colList.filter((t) => {\n              const params: [number, number, number] = [dayjsValue.hour(), dayjsValue.minute(), dayjsValue.second()];\n              params[colIdx] = Number(t);\n              return !disableTime?.(...params);\n            })\n          : colList;\n      }\n      // meridiem column scroller render\n      return MERIDIEM_LIST;\n    },\n    [steps, format, hideDisabledTime, dayjsValue, disableTime],\n  );\n\n  const getScrollDistance = useCallback(\n    (col: EPickerCols, time: number | string) => {\n      if (col === EPickerCols.hour && /[h]{1}/.test(format)) {\n        // eslint-disable-next-line no-param-reassign\n        (time as number) %= 12; // 一定是数字 直接cast\n      }\n\n      const itemIdx = getColList(col).indexOf(padStart(String(time), 2, '0'));\n      const timeItemTotalHeight = getItemHeight();\n      const distance = Math.abs(itemIdx * timeItemTotalHeight + timeItemTotalHeight / 2);\n      return distance;\n    },\n    [getItemHeight, getColList, format],\n  );\n\n  const handleScroll = (col: EPickerCols, idx: number, e: React.WheelEvent) => {\n    let val: number | string;\n    const isScrollUp = e.deltaY < 0;\n    const scrollTop = colsRef.current[idx]?.scrollTop;\n\n    const colStep = Math.abs(Math.round(scrollTop / getItemHeight() - (isScrollUp && scrollTop >= 1 ? 1 : 0)));\n    if (timeArr.includes(col)) {\n      // hour/minute/second col scroll\n      let max = 59;\n      if (col === EPickerCols.hour) {\n        max = /[h]{1}/.test(format) ? 11 : 23;\n      }\n      const colIdx = timeArr.indexOf(col);\n      const availableArr = range(0, max + 1, Number(steps[colIdx]));\n      val = closestLookup(\n        availableArr,\n        Number(getColList(col)[Math.min(colStep, max, availableArr.length - 1)]),\n        Number(steps[colIdx]),\n      );\n\n      if (col === EPickerCols.hour && cols.includes(EPickerCols.meridiem) && dayjsValue.hour() > 12) {\n        // 如果是十二小时制需要再判断\n        val = Number(val) + 12;\n      }\n      if (timeItemCanUsed(col, val)) onChange(dayjsValue[col]?.(val).format(format));\n    } else {\n      // meridiem col scroll\n      const meridiem = MERIDIEM_LIST[Math.min(colStep, 1)].toLowerCase(); // 处理PM/AM与am/pm\n\n      val = meridiem;\n\n      const currentHour = dayjsValue.hour();\n      if (meridiem === AM && currentHour >= 12) {\n        onChange(dayjsValue.hour(currentHour - 12).format(format));\n      } else if (meridiem === PM && currentHour < 12) {\n        onChange(dayjsValue.hour(currentHour + 12).format(format));\n      }\n    }\n    const distance = getScrollDistance(col, val);\n\n    if (distance !== scrollTop) {\n      const scroller = colsRef.current[cols.indexOf(col)];\n      if (!distance || !scroller || scroller.scrollTop === distance) return;\n\n      scroller.scrollTo({\n        top: distance,\n        behavior: 'smooth',\n      });\n    }\n  };\n\n  const scrollToTime = useCallback(\n    (col: EPickerCols, time: number | string, idx: number, behavior: 'auto' | 'smooth' = 'auto') => {\n      const distance = getScrollDistance(col, time);\n      const scroller = colsRef.current[idx];\n      if (!distance || !scroller || scroller.scrollTop === distance) return;\n\n      scroller.scrollTo({\n        top: distance,\n        behavior,\n      });\n    },\n    [getScrollDistance],\n  );\n\n  const handleTimeItemClick = (col: EPickerCols, el: string | number) => {\n    if (timeArr.includes(col)) {\n      if (col === EPickerCols.hour && dayjsValue.format('a') === PM && cols.includes(EPickerCols.meridiem)) {\n        // eslint-disable-next-line no-param-reassign\n        el = Number(el) + 12;\n      }\n      value ? onChange(dayjsValue[col]?.(el).format(format)) : onChange(dayjsValue[col]?.(el).format(format));\n    } else {\n      const currentHour = dayjsValue.hour();\n      if (el === AM && currentHour >= 12) {\n        onChange(dayjsValue.hour(currentHour - 12).format(format));\n      } else if (el === PM && currentHour < 12) {\n        onChange(dayjsValue.hour(currentHour + 12).format(format));\n      }\n    }\n  };\n\n  // update each columns scroll distance\n  const updateTimeScrollPos = useCallback(() => {\n    const behavior = value ? 'smooth' : 'auto';\n    const isStepsSet = !!steps.filter((v) => v > 1).length;\n\n    cols.forEach((col: EPickerCols, idx: number) => {\n      if (!isStepsSet || (isStepsSet && value)) {\n        // 如果没有设置大于1的steps或设置了大于1的step 正常处理滚动\n        scrollToTime(col, timeArr.includes(col) ? dayjsValue[col]?.() : dayjsValue.format('a'), idx, behavior);\n      } else {\n        // 否则初始化到每列第一个选项\n        scrollToTime(col, getColList(col)?.[0], idx, behavior);\n      }\n    });\n  }, [cols, scrollToTime, dayjsValue, value, steps, getColList]);\n\n  useEffect(() => {\n    updateTimeScrollPos();\n  });\n\n  const isCurrent = useCallback(\n    (col: EPickerCols, colItem: string | number) => {\n      let colVal: number;\n      if (col === EPickerCols.meridiem) {\n        const currentMeridiem = dayjsValue.format('a');\n        return currentMeridiem === colItem;\n      }\n      colVal = dayjsValue[col]?.();\n      if (col === EPickerCols.hour && /[h]{1}/.test(format)) {\n        colVal %= 12;\n      }\n      return colVal === Number(colItem);\n    },\n    [format, dayjsValue],\n  );\n\n  function renderScrollers() {\n    return cols.map((col, idx) => (\n      <ul\n        key={`${col}_${idx}`}\n        ref={(el) => (colsRef.current[idx] = el)}\n        className={`${panelClassName}-body-scroll`}\n        onWheel={debounce((e: React.WheelEvent) => handleScroll(col, idx, e), 50)}\n      >\n        {getColList(col).map((el) => (\n          <li\n            key={el}\n            className={classNames(`${panelClassName}-body-scroll-item`, {\n              [`${classPrefix}-is-disabled`]: !timeItemCanUsed(col, el),\n              [`${classPrefix}-is-current`]: isCurrent(col, el),\n            })}\n            onClick={() => handleTimeItemClick(col, el)}\n          >\n            {timeArr.includes(col) ? el : TEXT_CONFIG[el]}\n          </li>\n        ))}\n      </ul>\n    ));\n  }\n\n  return (\n    <div className={`${panelClassName}-body`}>\n      {/* render mask */}\n      <div className={`${panelClassName}-body-active-mask`} ref={maskRef}>\n        {cols.map((col, idx) => (\n          <div key={`${col}_${idx}`} />\n        ))}\n      </div>\n      {renderScrollers()}\n    </div>\n  );\n};\n\nexport default SinglePanel;\n"],"names":["nativeCeil","Math","ceil","nativeMax","max","baseRange","start","end","step","fromRight","index","length","result","Array","_baseRange","require$$0","isIterateeCall","require$$1","toFinite","require$$2","createRange","undefined","_createRange","range","range_1","timeArr","EPickerCols","hour","minute","second","SinglePanel","props","steps","format","onChange","noop","value","hideDisabledTime","disableTime","useConfig","classPrefix","TEXT_CONFIG","useTimePickerTextConfig","panelClassName","useState","cols","setCols","colsRef","useRef","maskRef","dayjsValue","useMemo","isStepsSet","filter","v","dayjs","useEffect","current","slice","match","startCol","hourCol","minuteCol","secondCol","endCol","meridiem","renderCol","getItemHeight","useCallback","maskDom","querySelector","timeItemTotalHeight","offsetHeight","parseInt","getComputedStyle","marginTop","closestLookup","availableArr","calcVal","sort","a","b","abs","timeItemCanUsed","col","el","colIdx","indexOf","params","getColList","count","includes","colStep","test","colList","Number","map","padStart","String","t","MERIDIEM_LIST","getScrollDistance","time","itemIdx","distance","handleScroll","idx","e","val","isScrollUp","deltaY","scrollTop","round","min","toLowerCase","currentHour","AM","PM","scroller","scrollTo","top","behavior","scrollToTime","handleTimeItemClick","updateTimeScrollPos","forEach","isCurrent","colItem","colVal","currentMeridiem","renderScrollers","React","createElement","key","ref","className","onWheel","debounce","classNames","onClick"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,IAAIA,UAAU,GAAGC,IAAI,CAACC,IAAtB;AAAA,IACIC,SAAS,GAAGF,IAAI,CAACG,GADrB;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,WAAT,CAAmBC,KAAnB,EAA0BC,GAA1B,EAA+BC,IAA/B,EAAqCC,SAArC,EAAgD;AAC9C,MAAIC,KAAK,GAAG,CAAC,CAAb;AAAA,MACIC,MAAM,GAAGR,SAAS,CAACH,UAAU,CAAC,CAACO,GAAG,GAAGD,KAAP,KAAiBE,IAAI,IAAI,CAAzB,CAAD,CAAX,EAA0C,CAA1C,CADtB;AAAA,MAEII,MAAM,GAAGC,KAAK,CAACF,MAAD,CAFlB;;AAIA,SAAOA,MAAM,EAAb,EAAiB;AACfC,IAAAA,MAAM,CAACH,SAAS,GAAGE,MAAH,GAAY,EAAED,KAAxB,CAAN,GAAuCJ,KAAvC;AACAA,IAAAA,KAAK,IAAIE,IAAT;AACD;;AACD,SAAOI,MAAP;AACD;;IAEDE,UAAc,GAAGT;;AC3BjB,IAAIA,SAAS,GAAGU,UAAhB;AAAA,IACIC,cAAc,GAAGC,+BADrB;AAAA,IAEIC,QAAQ,GAAGC,oBAFf;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,aAAT,CAAqBX,SAArB,EAAgC;AAC9B,SAAO,UAASH,KAAT,EAAgBC,GAAhB,EAAqBC,IAArB,EAA2B;AAChC,QAAIA,IAAI,IAAI,OAAOA,IAAP,IAAe,QAAvB,IAAmCQ,cAAc,CAACV,KAAD,EAAQC,GAAR,EAAaC,IAAb,CAArD,EAAyE;AACvED,MAAAA,GAAG,GAAGC,IAAI,GAAGa,SAAb;AACD,KAH+B;;;AAKhCf,IAAAA,KAAK,GAAGY,QAAQ,CAACZ,KAAD,CAAhB;;AACA,QAAIC,GAAG,KAAKc,SAAZ,EAAuB;AACrBd,MAAAA,GAAG,GAAGD,KAAN;AACAA,MAAAA,KAAK,GAAG,CAAR;AACD,KAHD,MAGO;AACLC,MAAAA,GAAG,GAAGW,QAAQ,CAACX,GAAD,CAAd;AACD;;AACDC,IAAAA,IAAI,GAAGA,IAAI,KAAKa,SAAT,GAAsBf,KAAK,GAAGC,GAAR,GAAc,CAAd,GAAkB,CAAC,CAAzC,GAA8CW,QAAQ,CAACV,IAAD,CAA7D;AACA,WAAOH,SAAS,CAACC,KAAD,EAAQC,GAAR,EAAaC,IAAb,EAAmBC,SAAnB,CAAhB;AACD,GAdD;AAeD;;IAEDa,YAAc,GAAGF;;AC7BjB,IAAIA,WAAW,GAAGL,YAAlB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIQ,KAAK,GAAGH,WAAW,EAAvB;IAEAI,OAAc,GAAGD;;ACnCjB,IAAME,OAAO,GAAG,CAACC,iCAAW,CAACC,IAAb,EAAmBD,iCAAW,CAACE,MAA/B,EAAuCF,iCAAW,CAACG,MAAnD,CAAhB;;IACMC,WAAW,GAAG,SAAdA,WAAc,CAACC,KAAD,EAAW;AAC7B,MAAQC,KAAR,GAAwFD,KAAxF,CAAQC,KAAR;AAAA,MAAeC,MAAf,GAAwFF,KAAxF,CAAeE,MAAf;AAAA,wBAAwFF,KAAxF,CAAuBG,QAAvB;AAAA,MAAuBA,QAAvB,gCAAkCC,qBAAlC;AAAA,MAAwCC,KAAxC,GAAwFL,KAAxF,CAAwCK,KAAxC;AAAA,8BAAwFL,KAAxF,CAA+CM,gBAA/C;AAAA,MAA+CA,gBAA/C,sCAAkE,IAAlE;AAAA,MAAwEC,WAAxE,GAAwFP,KAAxF,CAAwEO,WAAxE;;AACA,mBAAwBC,0BAAS,EAAjC;AAAA,MAAQC,WAAR,cAAQA,WAAR;;AACA,MAAMC,WAAW,GAAGC,yCAAuB,EAA3C;AACA,MAAMC,cAAc,aAAMH,WAAN,wBAApB;;AACA,kBAAwBI,cAAQ,CAAC,EAAD,CAAhC;AAAA;AAAA,MAAOC,IAAP;AAAA,MAAaC,OAAb;;AACA,MAAMC,OAAO,GAAGC,YAAM,CAAC,EAAD,CAAtB;AACA,MAAMC,OAAO,GAAGD,YAAM,CAAC,IAAD,CAAtB;AACA,MAAME,UAAU,GAAGC,aAAO,CAAC,YAAM;AAC/B,QAAMC,UAAU,GAAG,CAAC,CAACpB,KAAK,CAACqB,MAAN,CAAa,UAACC,CAAD;AAAA,aAAOA,CAAC,GAAG,CAAX;AAAA,KAAb,EAA2B3C,MAAhD;;AACA,QAAIyB,KAAJ,EAAW;AACT,aAAOmB,yBAAK,CAACnB,KAAD,EAAQH,MAAR,CAAZ;AACD;;AACD,QAAImB,UAAJ,EAAgB;AACd,aAAOG,yBAAK,GAAG5B,IAAR,CAAa,CAAb,EAAgBC,MAAhB,CAAuB,CAAvB,EAA0BC,MAA1B,CAAiC,CAAjC,CAAP;AACD;;AACD,WAAO0B,yBAAK,EAAZ;AACD,GATyB,EASvB,CAACnB,KAAD,EAAQH,MAAR,EAAgBD,KAAhB,CATuB,CAA1B;AAUAwB,EAAAA,eAAS,CAAC,YAAM;AACdT,IAAAA,OAAO,CAACU,OAAR,GAAkBV,OAAO,CAACU,OAAR,CAAgBC,KAAhB,CAAsB,CAAtB,EAAyBb,IAAI,CAAClC,MAA9B,CAAlB;AACD,GAFQ,EAEN,CAACkC,IAAD,CAFM,CAAT;AAGAW,EAAAA,eAAS,CAAC,YAAM;AACd,QAAMG,KAAK,GAAG1B,MAAM,CAAC0B,KAAP,CAAa,gDAAb,CAAd;;AACA,8CAA4DA,KAA5D;AAAA,QAASC,QAAT;AAAA,QAAmBC,OAAnB;AAAA,QAA4BC,SAA5B;AAAA,QAAuCC,SAAvC;AAAA,QAAkDC,MAAlD;;AACA,QAAQC,QAAR,GAA2CvC,iCAA3C,CAAQuC,QAAR;AAAA,QAAkBtC,IAAlB,GAA2CD,iCAA3C,CAAkBC,IAAlB;AAAA,QAAwBC,MAAxB,GAA2CF,iCAA3C,CAAwBE,MAAxB;AAAA,QAAgCC,MAAhC,GAA2CH,iCAA3C,CAAgCG,MAAhC;AACA,QAAMqC,SAAS,GAAG,CAChBN,QAAQ,IAAIK,QADI,EAEhBJ,OAAO,IAAIlC,IAFK,EAGhBmC,SAAS,IAAIlC,MAHG,EAIhBmC,SAAS,IAAIlC,MAJG,EAKhBmC,MAAM,IAAIC,QALM,EAMhBZ,MANgB,CAMT,UAACC,CAAD;AAAA,aAAO,CAAC,CAACA,CAAT;AAAA,KANS,CAAlB;AAOAR,IAAAA,OAAO,CAACoB,SAAD,CAAP;AACD,GAZQ,EAYN,CAACjC,MAAD,CAZM,CAAT;AAaA,MAAMkC,aAAa,GAAGC,iBAAW,CAAC,YAAM;AAAA;;AACtC,QAAMC,OAAO,GAAGpB,OAAH,aAAGA,OAAH,2CAAGA,OAAO,CAAEQ,OAAZ,qDAAG,iBAAkBa,aAAlB,CAAgC,KAAhC,CAAhB;AACA,QAAMC,mBAAmB,GAAGF,OAAO,CAACG,YAAR,GAAuBC,QAAQ,CAACC,gBAAgB,CAACL,OAAD,CAAhB,CAA0BM,SAA3B,EAAsC,EAAtC,CAA3D;AACA,WAAOJ,mBAAP;AACD,GAJgC,EAI9B,EAJ8B,CAAjC;;AAKA,MAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAACC,YAAD,EAAeC,OAAf,EAAwBtE,IAAxB,EAAiC;AACrD,QAAIA,IAAI,IAAI,CAAZ,EACE,OAAOsE,OAAP;AACF,WAAOD,YAAY,CAACE,IAAb,CAAkB,UAACC,CAAD,EAAIC,CAAJ;AAAA,aAAUhF,IAAI,CAACiF,GAAL,CAASJ,OAAO,GAAG,CAAV,GAAcE,CAAvB,IAA4B/E,IAAI,CAACiF,GAAL,CAASJ,OAAO,GAAG,CAAV,GAAcG,CAAvB,CAAtC;AAAA,KAAlB,EAAmF,CAAnF,CAAP;AACD,GAJD;;AAKA,MAAME,eAAe,GAAG,SAAlBA,eAAkB,CAACC,GAAD,EAAMC,EAAN,EAAa;AACnC,QAAMC,MAAM,GAAG7D,OAAO,CAAC8D,OAAR,CAAgBH,GAAhB,CAAf;;AACA,QAAIE,MAAM,KAAK,CAAC,CAAhB,EAAmB;AACjB,UAAME,MAAM,GAAG,CAACtC,UAAU,CAACvB,IAAX,EAAD,EAAoBuB,UAAU,CAACtB,MAAX,EAApB,EAAyCsB,UAAU,CAACrB,MAAX,EAAzC,CAAf;AACA2D,MAAAA,MAAM,CAACF,MAAD,CAAN,GAAiBD,EAAjB;AACA,aAAO,EAAE/C,WAAW,IAAIA,WAAJ,aAAIA,WAAJ,eAAIA,WAAW,MAAX,SAAiBkD,MAAjB,CAAjB,CAAP;AACD;;AACD,WAAO,IAAP;AACD,GARD;;AASA,MAAMC,UAAU,GAAGrB,iBAAW,CAAC,UAACgB,GAAD,EAAS;AACtC,QAAIM,KAAK,GAAG,CAAZ;;AACA,QAAIjE,OAAO,CAACkE,QAAR,CAAiBP,GAAjB,CAAJ,EAA2B;AACzB,UAAME,MAAM,GAAG7D,OAAO,CAAC8D,OAAR,CAAgBH,GAAhB,CAAf;AACA,UAAMQ,OAAO,GAAG5D,KAAK,CAACsD,MAAD,CAArB;;AACA,UAAIF,GAAG,KAAK1D,iCAAW,CAACC,IAAxB,EAA8B;AAC5B+D,QAAAA,KAAK,GAAG,SAASG,IAAT,CAAc5D,MAAd,IAAwB,EAAxB,GAA6B,EAArC;AACD,OAFD,MAEO;AACLyD,QAAAA,KAAK,GAAG,EAAR;AACD;;AACD,UAAMI,OAAO,GAAGvE,OAAK,CAAC,CAAD,EAAImE,KAAK,GAAG,CAAZ,EAAeK,MAAM,CAACH,OAAD,CAArB,CAAL,CAAqCI,GAArC,CAAyC,UAAC1C,CAAD;AAAA,eAAO2C,mBAAQ,CAACC,MAAM,CAAC5C,CAAD,CAAP,EAAY,CAAZ,EAAe,GAAf,CAAf;AAAA,OAAzC,KAAgF,EAAhG;AACA,aAAOjB,gBAAgB,IAAI,CAAC,CAACC,WAAtB,GAAoCwD,OAAO,CAACzC,MAAR,CAAe,UAAC8C,CAAD,EAAO;AAC/D,YAAMX,MAAM,GAAG,CAACtC,UAAU,CAACvB,IAAX,EAAD,EAAoBuB,UAAU,CAACtB,MAAX,EAApB,EAAyCsB,UAAU,CAACrB,MAAX,EAAzC,CAAf;AACA2D,QAAAA,MAAM,CAACF,MAAD,CAAN,GAAiBS,MAAM,CAACI,CAAD,CAAvB;AACA,eAAO,EAAC7D,WAAD,aAACA,WAAD,eAACA,WAAW,MAAX,SAAiBkD,MAAjB,CAAD,CAAP;AACD,OAJ0C,CAApC,GAIFM,OAJL;AAKD;;AACD,WAAOM,+BAAP;AACD,GAlB6B,EAkB3B,CAACpE,KAAD,EAAQC,MAAR,EAAgBI,gBAAhB,EAAkCa,UAAlC,EAA8CZ,WAA9C,CAlB2B,CAA9B;AAmBA,MAAM+D,iBAAiB,GAAGjC,iBAAW,CAAC,UAACgB,GAAD,EAAMkB,IAAN,EAAe;AACnD,QAAIlB,GAAG,KAAK1D,iCAAW,CAACC,IAApB,IAA4B,SAASkE,IAAT,CAAc5D,MAAd,CAAhC,EAAuD;AACrDqE,MAAAA,IAAI,IAAI,EAAR;AACD;;AACD,QAAMC,OAAO,GAAGd,UAAU,CAACL,GAAD,CAAV,CAAgBG,OAAhB,CAAwBU,mBAAQ,CAACC,MAAM,CAACI,IAAD,CAAP,EAAe,CAAf,EAAkB,GAAlB,CAAhC,CAAhB;AACA,QAAM/B,mBAAmB,GAAGJ,aAAa,EAAzC;AACA,QAAMqC,QAAQ,GAAGvG,IAAI,CAACiF,GAAL,CAASqB,OAAO,GAAGhC,mBAAV,GAAgCA,mBAAmB,GAAG,CAA/D,CAAjB;AACA,WAAOiC,QAAP;AACD,GARoC,EAQlC,CAACrC,aAAD,EAAgBsB,UAAhB,EAA4BxD,MAA5B,CARkC,CAArC;;AASA,MAAMwE,YAAY,GAAG,SAAfA,YAAe,CAACrB,GAAD,EAAMsB,GAAN,EAAWC,CAAX,EAAiB;AAAA;;AACpC,QAAIC,GAAJ;AACA,QAAMC,UAAU,GAAGF,CAAC,CAACG,MAAF,GAAW,CAA9B;AACA,QAAMC,SAAS,2BAAGhE,OAAO,CAACU,OAAR,CAAgBiD,GAAhB,CAAH,yDAAG,qBAAsBK,SAAxC;AACA,QAAMnB,OAAO,GAAG3F,IAAI,CAACiF,GAAL,CAASjF,IAAI,CAAC+G,KAAL,CAAWD,SAAS,GAAG5C,aAAa,EAAzB,IAA+B0C,UAAU,IAAIE,SAAS,IAAI,CAA3B,GAA+B,CAA/B,GAAmC,CAAlE,CAAX,CAAT,CAAhB;;AACA,QAAItF,OAAO,CAACkE,QAAR,CAAiBP,GAAjB,CAAJ,EAA2B;AAAA;;AACzB,UAAIhF,GAAG,GAAG,EAAV;;AACA,UAAIgF,GAAG,KAAK1D,iCAAW,CAACC,IAAxB,EAA8B;AAC5BvB,QAAAA,GAAG,GAAG,SAASyF,IAAT,CAAc5D,MAAd,IAAwB,EAAxB,GAA6B,EAAnC;AACD;;AACD,UAAMqD,MAAM,GAAG7D,OAAO,CAAC8D,OAAR,CAAgBH,GAAhB,CAAf;AACA,UAAMP,YAAY,GAAGtD,OAAK,CAAC,CAAD,EAAInB,GAAG,GAAG,CAAV,EAAa2F,MAAM,CAAC/D,KAAK,CAACsD,MAAD,CAAN,CAAnB,CAA1B;AACAsB,MAAAA,GAAG,GAAGhC,aAAa,CAACC,YAAD,EAAekB,MAAM,CAACN,UAAU,CAACL,GAAD,CAAV,CAAgBnF,IAAI,CAACgH,GAAL,CAASrB,OAAT,EAAkBxF,GAAlB,EAAuByE,YAAY,CAAClE,MAAb,GAAsB,CAA7C,CAAhB,CAAD,CAArB,EAAyFoF,MAAM,CAAC/D,KAAK,CAACsD,MAAD,CAAN,CAA/F,CAAnB;;AACA,UAAIF,GAAG,KAAK1D,iCAAW,CAACC,IAApB,IAA4BkB,IAAI,CAAC8C,QAAL,CAAcjE,iCAAW,CAACuC,QAA1B,CAA5B,IAAmEf,UAAU,CAACvB,IAAX,KAAoB,EAA3F,EAA+F;AAC7FiF,QAAAA,GAAG,GAAGb,MAAM,CAACa,GAAD,CAAN,GAAc,EAApB;AACD;;AACD,UAAIzB,eAAe,CAACC,GAAD,EAAMwB,GAAN,CAAnB,EACE1E,QAAQ,oBAACgB,UAAU,CAACkC,GAAD,CAAX,oDAAC,qBAAAlC,UAAU,EAAQ0D,GAAR,CAAV,CAAuB3E,MAAvB,CAA8BA,MAA9B,CAAD,CAAR;AACH,KAbD,MAaO;AACL,UAAMgC,QAAQ,GAAGmC,+BAAa,CAACnG,IAAI,CAACgH,GAAL,CAASrB,OAAT,EAAkB,CAAlB,CAAD,CAAb,CAAoCsB,WAApC,EAAjB;AACAN,MAAAA,GAAG,GAAG3C,QAAN;AACA,UAAMkD,WAAW,GAAGjE,UAAU,CAACvB,IAAX,EAApB;;AACA,UAAIsC,QAAQ,KAAKmD,oBAAb,IAAmBD,WAAW,IAAI,EAAtC,EAA0C;AACxCjF,QAAAA,QAAQ,CAACgB,UAAU,CAACvB,IAAX,CAAgBwF,WAAW,GAAG,EAA9B,EAAkClF,MAAlC,CAAyCA,MAAzC,CAAD,CAAR;AACD,OAFD,MAEO,IAAIgC,QAAQ,KAAKoD,oBAAb,IAAmBF,WAAW,GAAG,EAArC,EAAyC;AAC9CjF,QAAAA,QAAQ,CAACgB,UAAU,CAACvB,IAAX,CAAgBwF,WAAW,GAAG,EAA9B,EAAkClF,MAAlC,CAAyCA,MAAzC,CAAD,CAAR;AACD;AACF;;AACD,QAAMuE,QAAQ,GAAGH,iBAAiB,CAACjB,GAAD,EAAMwB,GAAN,CAAlC;;AACA,QAAIJ,QAAQ,KAAKO,SAAjB,EAA4B;AAC1B,UAAMO,QAAQ,GAAGvE,OAAO,CAACU,OAAR,CAAgBZ,IAAI,CAAC0C,OAAL,CAAaH,GAAb,CAAhB,CAAjB;AACA,UAAI,CAACoB,QAAD,IAAa,CAACc,QAAd,IAA0BA,QAAQ,CAACP,SAAT,KAAuBP,QAArD,EACE;AACFc,MAAAA,QAAQ,CAACC,QAAT,CAAkB;AAChBC,QAAAA,GAAG,EAAEhB,QADW;AAEhBiB,QAAAA,QAAQ,EAAE;AAFM,OAAlB;AAID;AACF,GAtCD;;AAuCA,MAAMC,YAAY,GAAGtD,iBAAW,CAAC,UAACgB,GAAD,EAAMkB,IAAN,EAAYI,GAAZ,EAAuC;AAAA,QAAtBe,QAAsB,uEAAX,MAAW;AACtE,QAAMjB,QAAQ,GAAGH,iBAAiB,CAACjB,GAAD,EAAMkB,IAAN,CAAlC;AACA,QAAMgB,QAAQ,GAAGvE,OAAO,CAACU,OAAR,CAAgBiD,GAAhB,CAAjB;AACA,QAAI,CAACF,QAAD,IAAa,CAACc,QAAd,IAA0BA,QAAQ,CAACP,SAAT,KAAuBP,QAArD,EACE;AACFc,IAAAA,QAAQ,CAACC,QAAT,CAAkB;AAChBC,MAAAA,GAAG,EAAEhB,QADW;AAEhBiB,MAAAA,QAAQ,EAARA;AAFgB,KAAlB;AAID,GAT+B,EAS7B,CAACpB,iBAAD,CAT6B,CAAhC;;AAUA,MAAMsB,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACvC,GAAD,EAAMC,EAAN,EAAa;AACvC,QAAI5D,OAAO,CAACkE,QAAR,CAAiBP,GAAjB,CAAJ,EAA2B;AAAA;;AACzB,UAAIA,GAAG,KAAK1D,iCAAW,CAACC,IAApB,IAA4BuB,UAAU,CAACjB,MAAX,CAAkB,GAAlB,MAA2BoF,oBAAvD,IAA6DxE,IAAI,CAAC8C,QAAL,CAAcjE,iCAAW,CAACuC,QAA1B,CAAjE,EAAsG;AACpGoB,QAAAA,EAAE,GAAGU,MAAM,CAACV,EAAD,CAAN,GAAa,EAAlB;AACD;;AACDjD,MAAAA,KAAK,GAAGF,QAAQ,qBAACgB,UAAU,CAACkC,GAAD,CAAX,qDAAC,sBAAAlC,UAAU,EAAQmC,EAAR,CAAV,CAAsBpD,MAAtB,CAA6BA,MAA7B,CAAD,CAAX,GAAoDC,QAAQ,qBAACgB,UAAU,CAACkC,GAAD,CAAX,qDAAC,sBAAAlC,UAAU,EAAQmC,EAAR,CAAV,CAAsBpD,MAAtB,CAA6BA,MAA7B,CAAD,CAAjE;AACD,KALD,MAKO;AACL,UAAMkF,WAAW,GAAGjE,UAAU,CAACvB,IAAX,EAApB;;AACA,UAAI0D,EAAE,KAAK+B,oBAAP,IAAaD,WAAW,IAAI,EAAhC,EAAoC;AAClCjF,QAAAA,QAAQ,CAACgB,UAAU,CAACvB,IAAX,CAAgBwF,WAAW,GAAG,EAA9B,EAAkClF,MAAlC,CAAyCA,MAAzC,CAAD,CAAR;AACD,OAFD,MAEO,IAAIoD,EAAE,KAAKgC,oBAAP,IAAaF,WAAW,GAAG,EAA/B,EAAmC;AACxCjF,QAAAA,QAAQ,CAACgB,UAAU,CAACvB,IAAX,CAAgBwF,WAAW,GAAG,EAA9B,EAAkClF,MAAlC,CAAyCA,MAAzC,CAAD,CAAR;AACD;AACF;AACF,GAdD;;AAeA,MAAM2F,mBAAmB,GAAGxD,iBAAW,CAAC,YAAM;AAC5C,QAAMqD,QAAQ,GAAGrF,KAAK,GAAG,QAAH,GAAc,MAApC;AACA,QAAMgB,UAAU,GAAG,CAAC,CAACpB,KAAK,CAACqB,MAAN,CAAa,UAACC,CAAD;AAAA,aAAOA,CAAC,GAAG,CAAX;AAAA,KAAb,EAA2B3C,MAAhD;AACAkC,IAAAA,IAAI,CAACgF,OAAL,CAAa,UAACzC,GAAD,EAAMsB,GAAN,EAAc;AACzB,UAAI,CAACtD,UAAD,IAAeA,UAAU,IAAIhB,KAAjC,EAAwC;AAAA;;AACtCsF,QAAAA,YAAY,CAACtC,GAAD,EAAM3D,OAAO,CAACkE,QAAR,CAAiBP,GAAjB,wBAAwBlC,UAAU,CAACkC,GAAD,CAAlC,qDAAwB,sBAAAlC,UAAU,CAAlC,GAA8CA,UAAU,CAACjB,MAAX,CAAkB,GAAlB,CAApD,EAA4EyE,GAA5E,EAAiFe,QAAjF,CAAZ;AACD,OAFD,MAEO;AAAA;;AACLC,QAAAA,YAAY,CAACtC,GAAD,iBAAMK,UAAU,CAACL,GAAD,CAAhB,gDAAM,YAAkB,CAAlB,CAAN,EAA4BsB,GAA5B,EAAiCe,QAAjC,CAAZ;AACD;AACF,KAND;AAOD,GAVsC,EAUpC,CAAC5E,IAAD,EAAO6E,YAAP,EAAqBxE,UAArB,EAAiCd,KAAjC,EAAwCJ,KAAxC,EAA+CyD,UAA/C,CAVoC,CAAvC;AAWAjC,EAAAA,eAAS,CAAC,YAAM;AACdoE,IAAAA,mBAAmB;AACpB,GAFQ,CAAT;AAGA,MAAME,SAAS,GAAG1D,iBAAW,CAAC,UAACgB,GAAD,EAAM2C,OAAN,EAAkB;AAAA;;AAC9C,QAAIC,MAAJ;;AACA,QAAI5C,GAAG,KAAK1D,iCAAW,CAACuC,QAAxB,EAAkC;AAChC,UAAMgE,eAAe,GAAG/E,UAAU,CAACjB,MAAX,CAAkB,GAAlB,CAAxB;AACA,aAAOgG,eAAe,KAAKF,OAA3B;AACD;;AACDC,IAAAA,MAAM,uBAAG9E,UAAU,CAACkC,GAAD,CAAb,qDAAG,sBAAAlC,UAAU,CAAnB;;AACA,QAAIkC,GAAG,KAAK1D,iCAAW,CAACC,IAApB,IAA4B,SAASkE,IAAT,CAAc5D,MAAd,CAAhC,EAAuD;AACrD+F,MAAAA,MAAM,IAAI,EAAV;AACD;;AACD,WAAOA,MAAM,KAAKjC,MAAM,CAACgC,OAAD,CAAxB;AACD,GAX4B,EAW1B,CAAC9F,MAAD,EAASiB,UAAT,CAX0B,CAA7B;;AAYA,WAASgF,eAAT,GAA2B;AACzB,WAAOrF,IAAI,CAACmD,GAAL,CAAS,UAACZ,GAAD,EAAMsB,GAAN;AAAA,4BAA8ByB,yBAAK,CAACC,aAAN,CAAoB,IAApB,EAA0B;AACtEC,QAAAA,GAAG,YAAKjD,GAAL,cAAYsB,GAAZ,CADmE;AAEtE4B,QAAAA,GAAG,EAAE,aAACjD,EAAD;AAAA,iBAAQtC,OAAO,CAACU,OAAR,CAAgBiD,GAAhB,IAAuBrB,EAA/B;AAAA,SAFiE;AAGtEkD,QAAAA,SAAS,YAAK5F,cAAL,iBAH6D;AAItE6F,QAAAA,OAAO,EAAEC,mBAAQ,CAAC,UAAC9B,CAAD;AAAA,iBAAOF,YAAY,CAACrB,GAAD,EAAMsB,GAAN,EAAWC,CAAX,CAAnB;AAAA,SAAD,EAAmC,EAAnC;AAJqD,OAA1B,EAK3ClB,UAAU,CAACL,GAAD,CAAV,CAAgBY,GAAhB,CAAoB,UAACX,EAAD;AAAA;;AAAA,8BAAwB8C,yBAAK,CAACC,aAAN,CAAoB,IAApB,EAA0B;AACvEC,UAAAA,GAAG,EAAEhD,EADkE;AAEvEkD,UAAAA,SAAS,EAAEG,8BAAU,WAAI/F,cAAJ,iGACfH,WADe,mBACa,CAAC2C,eAAe,CAACC,GAAD,EAAMC,EAAN,CAD7B,yDAEf7C,WAFe,kBAEYsF,SAAS,CAAC1C,GAAD,EAAMC,EAAN,CAFrB,gBAFkD;AAMvEsD,UAAAA,OAAO,EAAE;AAAA,mBAAMhB,mBAAmB,CAACvC,GAAD,EAAMC,EAAN,CAAzB;AAAA;AAN8D,SAA1B,EAO5C5D,OAAO,CAACkE,QAAR,CAAiBP,GAAjB,IAAwBC,EAAxB,GAA6B5C,WAAW,CAAC4C,EAAD,CAPI,CAAxB;AAAA,OAApB,CAL2C,CAA9B;AAAA,KAAT,CAAP;AAaD;;AACD,wBAAuB8C,yBAAK,CAACC,aAAN,CAAoB,KAApB,EAA2B;AAChDG,IAAAA,SAAS,YAAK5F,cAAL;AADuC,GAA3B,iBAEJwF,yBAAK,CAACC,aAAN,CAAoB,KAApB,EAA2B;AAC5CG,IAAAA,SAAS,YAAK5F,cAAL,sBADmC;AAE5C2F,IAAAA,GAAG,EAAErF;AAFuC,GAA3B,EAGhBJ,IAAI,CAACmD,GAAL,CAAS,UAACZ,GAAD,EAAMsB,GAAN;AAAA,0BAA8ByB,yBAAK,CAACC,aAAN,CAAoB,KAApB,EAA2B;AACnEC,MAAAA,GAAG,YAAKjD,GAAL,cAAYsB,GAAZ;AADgE,KAA3B,CAA9B;AAAA,GAAT,CAHgB,CAFI,EAOjBwB,eAAe,EAPE,CAAvB;AAQD;;;;"}