{"version":3,"file":"Alert.js","sources":["../../src/alert/Alert.tsx"],"sourcesContent":["import React, { forwardRef } from 'react';\nimport classNames from 'classnames';\nimport { InfoCircleFilledIcon, CloseIcon, CheckCircleFilledIcon, ErrorCircleFilledIcon } from 'tdesign-icons-react';\nimport useConfig from '../_util/useConfig';\nimport noop from '../_util/noop';\nimport { TdAlertProps } from './type';\nimport { StyledProps } from '../common';\n\nexport interface AlertProps extends TdAlertProps, StyledProps {}\n\nconst Alert = forwardRef((props: AlertProps, ref: React.Ref<HTMLDivElement>) => {\n  const { message, title, operation, theme = 'info', icon, close, maxLine, onClose = noop, ...alertProps } = props;\n\n  const [closed, setClosed] = React.useState(false);\n  const [collapsed, setCollapsed] = React.useState(false);\n  const { classPrefix } = useConfig();\n  const iconMap = {\n    success: CheckCircleFilledIcon,\n    info: InfoCircleFilledIcon,\n    error: ErrorCircleFilledIcon,\n    warning: ErrorCircleFilledIcon,\n  };\n\n  const handleClose = (e: React.MouseEvent<HTMLDivElement>) => {\n    setClosed(true);\n    onClose?.({ e });\n  };\n\n  const handleCollapse = () => {\n    setCollapsed(!collapsed);\n  };\n\n  const renderIconNode = () => {\n    if (React.isValidElement(icon)) {\n      return React.cloneElement(icon as React.ReactElement, {\n        className: classNames({\n          [icon.props.className]: icon.props.className,\n        }),\n      });\n    }\n    return React.createElement(iconMap[theme]);\n  };\n\n  const renderMessage = () => {\n    if (+maxLine > 0 && Array.isArray(message)) {\n      return (\n        <div className={`${classPrefix}-alert__description`}>\n          {message.map((item, index) => {\n            if (!collapsed) {\n              if (index < maxLine) {\n                return <div key={index}>{item}</div>;\n              }\n            } else {\n              return <div key={index}>{item}</div>;\n            }\n            return true;\n          })}\n          {+maxLine > 0 ? (\n            <div className={`${classPrefix}-alert__collapse`} onClick={handleCollapse}>\n              {!collapsed ? '展开更多' : '收起'}\n            </div>\n          ) : null}\n        </div>\n      );\n    }\n    return <div className={`${classPrefix}-alert__description`}>{message}</div>;\n  };\n\n  const renderClose = () => (\n    <div className={`${classPrefix}-alert__close`} onClick={handleClose}>\n      {typeof close === 'boolean' ? <CloseIcon /> : close}\n    </div>\n  );\n\n  return closed ? null : (\n    <div\n      ref={ref}\n      className={classNames(`${classPrefix}-alert`, {\n        [`${classPrefix}-alert--${theme}`]: true,\n      })}\n      {...alertProps}\n    >\n      <div className={`${classPrefix}-alert__icon`}>{renderIconNode()}</div>\n      <div className={`${classPrefix}-alert__content`}>\n        {title ? <div className={`${classPrefix}-alert__title`}>{title}</div> : null}\n        <div className={`${classPrefix}-alert__message`}>\n          {renderMessage()}\n          {operation ? <div className={`${classPrefix}-alert__operation`}>{operation}</div> : null}\n        </div>\n      </div>\n      {close ? renderClose() : null}\n    </div>\n  );\n});\n\nAlert.displayName = 'Alert';\n\nexport default Alert;\n"],"names":["Alert","forwardRef","props","ref","message","title","operation","theme","icon","close","maxLine","onClose","noop","alertProps","React","useState","closed","setClosed","collapsed","setCollapsed","useConfig","classPrefix","iconMap","success","CheckCircleFilledIcon","info","InfoCircleFilledIcon","error","ErrorCircleFilledIcon","warning","handleClose","e","handleCollapse","renderIconNode","isValidElement","cloneElement","className","classNames","createElement","renderMessage","Array","isArray","map","item","index","key","onClick","renderClose","CloseIcon","displayName"],"mappings":"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"}