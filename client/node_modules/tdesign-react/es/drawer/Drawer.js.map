{"version":3,"file":"Drawer.js","sources":["../../src/drawer/Drawer.tsx"],"sourcesContent":["import React, { forwardRef, useState, useContext, useEffect, useImperativeHandle, useRef } from 'react';\nimport classnames from 'classnames';\nimport { CloseIcon } from 'tdesign-icons-react';\n\nimport { addClass, removeClass } from '../_util/dom';\nimport { useLocaleReceiver } from '../locale/LocalReceiver';\nimport { ConfigContext } from '../config-provider';\nimport getScrollbarWidth from '../_util/getScrollbarWidth';\nimport hasScrollBar from '../_util/hasScrollBar';\nimport { TdDrawerProps, DrawerEventSource } from './type';\nimport { StyledProps } from '../common';\nimport DrawerWrapper from './DrawerWrapper';\nimport Button from '../button';\n\nexport const CloseTriggerType: { [key: string]: DrawerEventSource } = {\n  CLICK_OVERLAY: 'overlay',\n  CLICK_CLOSE_BTN: 'close-btn',\n  CLICK_CANCEL_BTN: 'cancel',\n  KEYDOWN_ESC: 'esc',\n};\n\nexport interface DrawerProps extends TdDrawerProps, StyledProps {}\n\nconst getSizeValue = (size: string): string => {\n  const defaultSize = isNaN(Number(size)) ? size : `${size}px`;\n  return (\n    {\n      small: '300px',\n      medium: '500px',\n      large: '760px',\n    }[size] || defaultSize\n  );\n};\n\nconst Drawer = forwardRef((props: DrawerProps, ref: React.Ref<HTMLDivElement>) => {\n  const {\n    className,\n    style,\n    visible,\n    attach = '',\n    showOverlay,\n    size,\n    placement,\n    onCancel,\n    onConfirm,\n    onClose,\n    onCloseBtnClick,\n    onOverlayClick,\n    onEscKeydown,\n    showInAttachedElement,\n    closeOnOverlayClick,\n    closeOnEscKeydown,\n    children,\n    header,\n    body,\n    footer,\n    closeBtn,\n    cancelBtn,\n    confirmBtn,\n    zIndex,\n    destroyOnClose,\n    mode,\n    preventScrollThrough = true,\n  } = props;\n\n  // 国际化文本初始化\n  const [local, t] = useLocaleReceiver('drawer');\n  const confirmText = t(local.confirm);\n  const cancelText = t(local.cancel);\n\n  const { classPrefix } = useContext(ConfigContext);\n  const containerRef = useRef<HTMLDivElement>();\n  const contentWrapperRef = useRef<HTMLDivElement>();\n  const drawerRef = useRef<HTMLElement>(); // 即最终的 attach dom，默认为 document.body\n  const prefixCls = `${classPrefix}-drawer`;\n  const lockCls = `${prefixCls}--lock`;\n\n  const transform = visible ? 'translate(0px)' : '';\n  const closeIcon = React.isValidElement(closeBtn) ? closeBtn : <CloseIcon />;\n\n  const [isDestroyOnClose, setIsDestroyOnClose] = useState(false);\n\n  useImperativeHandle(ref, () => containerRef.current);\n\n  useEffect(() => {\n    if (preventScrollThrough) {\n      if (visible && !showInAttachedElement) {\n        addClass(document.body, lockCls);\n      } else {\n        removeClass(document.body, lockCls);\n      }\n    }\n  }, [visible, showInAttachedElement, lockCls, preventScrollThrough]);\n\n  // 重置销毁钩子判断\n  useEffect(() => {\n    if (!destroyOnClose || !visible) return;\n    setIsDestroyOnClose(false);\n  }, [visible, destroyOnClose]);\n\n  useEffect(() => {\n    let documentBodyCssText = '';\n\n    if (visible) {\n      if (attach !== '' && hasScrollBar()) {\n        // 处理滚动条宽度导致晃动的问题。\n        const scrollbarWidth = getScrollbarWidth();\n        documentBodyCssText = `overflow: hidden; width: calc(100% - ${scrollbarWidth}px);`;\n\n        if (mode !== 'push') {\n          // 这里做简单的性能优化，如果是 body 那么在下面 mode=push 的模式下，一起使用 cssText 设置，减少重绘重排\n          document.body.style.cssText = documentBodyCssText;\n        }\n      }\n    }\n\n    if (mode === 'push') {\n      drawerRef.current.style.cssText = 'transition: margin 300ms cubic-bezier(0.7, 0.3, 0.1, 1) 0s';\n\n      const marginStr = {\n        left: `margin: 0 0 0 ${getSizeValue(size)}`,\n        right: `margin: 0 0 0 -${getSizeValue(size)}`,\n        top: `margin: ${getSizeValue(size)} 0 0 0`,\n        bottom: `margin: -${getSizeValue(size)} 0 0 0`,\n      }[placement];\n\n      if (visible) {\n        drawerRef.current.style.cssText += marginStr;\n      } else {\n        drawerRef.current.style.cssText = drawerRef.current.style.cssText.replace(/margin:.+;/, '');\n      }\n    }\n\n    if (contentWrapperRef.current) {\n      // 聚焦到 Drawer 最外层元素即 containerRef.current，KeyDown 事件才有效。\n      containerRef.current.focus();\n\n      contentWrapperRef.current.style.transform = transform;\n    }\n  }, [attach, mode, transform, visible, placement, size]);\n\n  function onMaskClick(e: React.MouseEvent<HTMLDivElement>) {\n    onOverlayClick?.({ e });\n    closeOnOverlayClick && onClose?.({ e, trigger: CloseTriggerType.CLICK_OVERLAY });\n  }\n  function onClickCloseBtn(e: React.MouseEvent<HTMLDivElement>) {\n    onCloseBtnClick?.({ e });\n    onClose?.({ e, trigger: CloseTriggerType.CLICK_CLOSE_BTN });\n  }\n  function onKeyDownEsc(e: React.KeyboardEvent<HTMLDivElement>) {\n    if (e.key !== 'Escape') return;\n\n    onEscKeydown?.({ e });\n    closeOnEscKeydown && onClose?.({ e, trigger: CloseTriggerType.KEYDOWN_ESC });\n  }\n  function onCancelClick(e: React.MouseEvent<HTMLButtonElement>) {\n    onCancel?.({ e });\n    onClose?.({ e, trigger: CloseTriggerType.CLICK_CANCEL_BTN });\n  }\n  function onConfirmClick(e: React.MouseEvent<HTMLButtonElement>) {\n    onConfirm?.({ e });\n  }\n\n  function onTransitionEnd() {\n    if (!visible) {\n      // 重置样式\n      document.body.style.display = 'none';\n      document.body.style.overflow = '';\n      document.body.style.width = '';\n      document.body.style.margin = '';\n      document.body.style.display = 'block';\n\n      destroyOnClose && setIsDestroyOnClose(true);\n    }\n  }\n\n  const drawerClass = classnames(prefixCls, className, `${prefixCls}--${placement}`, {\n    [`${prefixCls}--open`]: visible,\n    [`${prefixCls}--attach`]: showInAttachedElement,\n    [`${prefixCls}--without-mask`]: !showOverlay,\n  });\n\n  const contentWrapperClass = classnames(\n    `${prefixCls}__content-wrapper`,\n    `${prefixCls}__content-wrapper--${placement}`,\n  );\n  const contentWrapperStyle = {\n    transform: visible ? 'translateX(0)' : undefined,\n    width: ['left', 'right'].includes(placement) ? getSizeValue(size) : '',\n    height: ['top', 'bottom'].includes(placement) ? getSizeValue(size) : '',\n  };\n\n  function getFooter(): React.ReactNode {\n    if (footer !== true) return footer;\n\n    const defaultCancelBtn = (\n      <Button theme=\"default\" onClick={onCancelClick} className={`${prefixCls}__cancel`}>\n        {cancelText}\n      </Button>\n    );\n\n    const defaultConfirmBtn = (\n      <Button theme=\"primary\" onClick={onConfirmClick} className={`${prefixCls}__confirm`}>\n        {confirmText}\n      </Button>\n    );\n\n    const renderCancelBtn = cancelBtn && React.isValidElement(cancelBtn) ? cancelBtn : defaultCancelBtn;\n    const renderConfirmBtn = confirmBtn && React.isValidElement(confirmBtn) ? confirmBtn : defaultConfirmBtn;\n\n    const footerStyle = {\n      display: 'flex',\n      justifyContent: placement === 'right' ? 'flex-start' : 'flex-end',\n    };\n\n    return (\n      <div style={footerStyle}>\n        {placement === 'right' && renderConfirmBtn}\n        {renderCancelBtn}\n        {placement !== 'right' && renderConfirmBtn}\n      </div>\n    );\n  }\n\n  const renderOverlay = showOverlay && <div className={`${prefixCls}__mask`} onClick={onMaskClick} />;\n  const renderCloseBtn = closeBtn && (\n    <div onClick={onClickCloseBtn} className={`${prefixCls}__close-btn`}>\n      {closeIcon}\n    </div>\n  );\n  const renderHeader = header && <div className={`${prefixCls}__header`}>{header}</div>;\n  const renderBody = <div className={`${prefixCls}__body`}>{body || children}</div>;\n  const renderFooter = footer && <div className={`${prefixCls}__footer`}>{getFooter()}</div>;\n\n  if (isDestroyOnClose && !visible) return null;\n\n  return (\n    <DrawerWrapper attach={attach} ref={drawerRef}>\n      <div\n        ref={containerRef}\n        className={drawerClass}\n        style={{ zIndex, ...style }}\n        tabIndex={0} // https://stackoverflow.com/questions/43503964/onkeydown-event-not-working-on-divs-in-react\n        onKeyDown={onKeyDownEsc}\n        onTransitionEnd={onTransitionEnd}\n      >\n        {renderOverlay}\n        <div ref={contentWrapperRef} className={contentWrapperClass} style={contentWrapperStyle}>\n          {renderCloseBtn}\n          {renderHeader}\n          {renderBody}\n          {renderFooter}\n        </div>\n      </div>\n    </DrawerWrapper>\n  );\n});\n\nDrawer.defaultProps = {\n  attach: '',\n  closeBtn: true,\n  closeOnOverlayClick: true,\n  closeOnEscKeydown: true,\n  size: 'small',\n  placement: 'right',\n  mode: 'overlay',\n  destroyOnClose: false,\n  showOverlay: true,\n  header: undefined,\n  footer: true,\n};\n\nDrawer.displayName = 'Drawer';\n\nexport default Drawer;\n"],"names":["CloseTriggerType","CLICK_OVERLAY","CLICK_CLOSE_BTN","CLICK_CANCEL_BTN","KEYDOWN_ESC","getSizeValue","size","defaultSize","isNaN","Number","small","medium","large","Drawer","forwardRef","props","ref","className","style","visible","attach","showOverlay","placement","onCancel","onConfirm","onClose","onCloseBtnClick","onOverlayClick","onEscKeydown","showInAttachedElement","closeOnOverlayClick","closeOnEscKeydown","children","header","body","footer","closeBtn","cancelBtn","confirmBtn","zIndex","destroyOnClose","mode","preventScrollThrough","useLocaleReceiver","local","t","confirmText","confirm","cancelText","cancel","useContext","ConfigContext","classPrefix","containerRef","useRef","contentWrapperRef","drawerRef","prefixCls","lockCls","transform","closeIcon","React","isValidElement","createElement","CloseIcon","useState","isDestroyOnClose","setIsDestroyOnClose","useImperativeHandle","current","useEffect","addClass","document","removeClass","documentBodyCssText","hasScrollBar","scrollbarWidth","getScrollbarWidth","cssText","marginStr","left","right","top","bottom","replace","focus","onMaskClick","e","trigger","onClickCloseBtn","onKeyDownEsc","key","onCancelClick","onConfirmClick","onTransitionEnd","display","overflow","width","margin","drawerClass","classnames","contentWrapperClass","contentWrapperStyle","includes","height","getFooter","defaultCancelBtn","Button","theme","onClick","defaultConfirmBtn","renderCancelBtn","renderConfirmBtn","footerStyle","justifyContent","renderOverlay","renderCloseBtn","renderHeader","renderBody","renderFooter","DrawerWrapper","tabIndex","onKeyDown","defaultProps","displayName"],"mappings":"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"}