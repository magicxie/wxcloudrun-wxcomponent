{"version":3,"file":"useDefaultValue.js","sources":["../../../src/upload/hooks/useDefaultValue.ts"],"sourcesContent":["import { useMemo } from 'react';\nimport isArray from 'lodash/isArray';\nimport useDefault from '../../_util/useDefault';\nimport noop from '../../_util/noop';\nimport { UploadProps } from '../types';\n\nexport default function useDefaultValue<T, P extends UploadProps>(props: P, defaultDefaultValue?: T) {\n  type ReturnType = Omit<P, 'defaultFiles'>;\n\n  const { value, defaultFiles, files, onChange = noop, ...restProps } = props;\n\n  // 兼容form value props 且 form props 优先\n  const controlledValue = useMemo(() => {\n    // form 设置的默认值空字符串\n    const formValue = value !== undefined && !isArray(value) ? [] : value;\n    return formValue || files;\n  }, [files, value]);\n\n  const [finalValue, finalOnChange] = useDefault(\n    controlledValue,\n    typeof defaultFiles === 'undefined' ? defaultDefaultValue : defaultFiles,\n    onChange,\n  );\n\n  return {\n    files: finalValue,\n    onChange: finalOnChange,\n    ...restProps,\n  } as ReturnType;\n}\n"],"names":["useDefaultValue","props","defaultDefaultValue","value","defaultFiles","files","onChange","noop","restProps","controlledValue","useMemo","formValue","isArray","useDefault","finalValue","finalOnChange"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAIe,SAASA,eAAT,CAAyBC,KAAzB,EAAgCC,mBAAhC,EAAqD;AAClE,MAAQC,KAAR,GAAsEF,KAAtE,CAAQE,KAAR;AAAA,MAAeC,YAAf,GAAsEH,KAAtE,CAAeG,YAAf;AAAA,MAA6BC,KAA7B,GAAsEJ,KAAtE,CAA6BI,KAA7B;AAAA,wBAAsEJ,KAAtE,CAAoCK,QAApC;AAAA,MAAoCA,QAApC,gCAA+CC,IAA/C;AAAA,MAAwDC,SAAxD,4BAAsEP,KAAtE;;AACA,MAAMQ,eAAe,GAAGC,OAAO,CAAC,YAAM;AACpC,QAAMC,SAAS,GAAGR,KAAK,KAAK,KAAK,CAAf,IAAoB,CAACS,SAAO,CAACT,KAAD,CAA5B,GAAsC,EAAtC,GAA2CA,KAA7D;AACA,WAAOQ,SAAS,IAAIN,KAApB;AACD,GAH8B,EAG5B,CAACA,KAAD,EAAQF,KAAR,CAH4B,CAA/B;;AAIA,oBAAoCU,UAAU,CAACJ,eAAD,EAAkB,OAAOL,YAAP,KAAwB,WAAxB,GAAsCF,mBAAtC,GAA4DE,YAA9E,EAA4FE,QAA5F,CAA9C;AAAA;AAAA,MAAOQ,UAAP;AAAA,MAAmBC,aAAnB;;AACA;AACEV,IAAAA,KAAK,EAAES,UADT;AAEER,IAAAA,QAAQ,EAAES;AAFZ,KAGKP,SAHL;AAKD;;;;"}