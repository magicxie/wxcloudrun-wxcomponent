{"version":3,"file":"dep-a5b60243.js","sources":["../../src/avatar/AvararGroup.tsx","../../src/avatar/Avatar.tsx"],"sourcesContent":["import React from 'react';\nimport classNames from 'classnames';\nimport Avatar from './Avatar';\nimport Popup from '../popup/Popup';\nimport useConfig from '../_util/useConfig';\nimport { AvatarContextProvider } from './AvatarContext';\nimport { TdAvatarGroupProps } from './type';\nimport { StyledProps } from '../common';\n\nexport interface AvatarGroupProps extends TdAvatarGroupProps, StyledProps {\n  children?: React.ReactNode;\n}\nconst Group: React.FC<AvatarGroupProps> = (props) => {\n  const { classPrefix } = useConfig();\n  const preClass = `${classPrefix}-avatar`;\n  const {\n    className,\n    cascading = 'right-up',\n    collapseAvatar,\n    max,\n    placement,\n    popupProps,\n    size = 'medium',\n    children,\n    ...avatarGroupProps\n  } = props;\n\n  const childrenList = React.Children.toArray(children);\n  let allChildrenList;\n  if (childrenList.length > 0) {\n    allChildrenList = childrenList.map((child: JSX.Element, index: number) =>\n      React.cloneElement(child, { key: `avatar-group-item-${index}`, ...child.props }),\n    );\n  }\n  const groupClass = classNames(`${preClass}-group`, className, {\n    [`${preClass}--offset-right`]: cascading === 'right-up',\n    [`${preClass}--offset-left`]: cascading === 'left-up',\n  });\n  const childrenCount = childrenList.length;\n  if (max && childrenCount > max) {\n    const showList = allChildrenList.slice(0, max);\n    const hiddenList = allChildrenList.slice(max, childrenCount);\n    const popupNum = `+${childrenCount - max}`;\n    const popupMergeProps = { ...popupProps, placement };\n    const popupNodes = popupProps ? (\n      <Popup {...popupMergeProps}>\n        {collapseAvatar ? <Avatar size={size}>{collapseAvatar}</Avatar> : <Avatar size={size}>{popupNum}</Avatar>}\n      </Popup>\n    ) : (\n      <Popup key=\"avatar-popup-key\" placement={placement} content={hiddenList} trigger=\"hover\" showArrow>\n        {collapseAvatar ? <Avatar size={size}>{collapseAvatar}</Avatar> : <Avatar size={size}>{popupNum}</Avatar>}\n      </Popup>\n    );\n    showList.push(popupNodes);\n    return (\n      <AvatarContextProvider size={size}>\n        <div className={groupClass}>{showList}</div>\n      </AvatarContextProvider>\n    );\n  }\n  return (\n    <AvatarContextProvider size={size}>\n      <div className={groupClass} {...avatarGroupProps}>\n        {allChildrenList}\n      </div>\n    </AvatarContextProvider>\n  );\n};\nexport default Group;\n","import React, { useRef, useState, useEffect, useContext, Ref } from 'react';\nimport useResizeObserver from 'use-resize-observer';\nimport classNames from 'classnames';\nimport useConfig from '../_util/useConfig';\nimport forwardRefWithStatics from '../_util/forwardRefWithStatics';\nimport useCommonClassName from '../_util/useCommonClassName';\nimport composeRefs from '../_util/composeRefs';\nimport { TdAvatarProps } from './type';\nimport { StyledProps } from '../common';\nimport AvatarContext from './AvatarContext';\nimport AvatarGroup from './AvararGroup';\n\nexport interface AvatarProps extends TdAvatarProps, StyledProps {\n  children?: React.ReactNode;\n}\n\nconst Avatar = forwardRefWithStatics(\n  (props: AvatarProps, ref: Ref<HTMLElement>) => {\n    const {\n      alt,\n      hideOnLoadFailed = false,\n      icon,\n      image,\n      shape = 'circle',\n      size: avatarSize = 'default',\n      onError,\n      children,\n      style,\n      className,\n      ...avatarProps\n    } = props;\n    const groupSize = useContext(AvatarContext);\n    const { classPrefix } = useConfig();\n    const [scale, setScale] = useState(1);\n    const [isImgExist, setIsImgExist] = useState(true);\n    const avatarRef = useRef<HTMLElement>(null);\n    const avatarChildrenRef = useRef<HTMLElement>(null);\n    const size = avatarSize === 'default' ? groupSize : avatarSize;\n    const gap = 4;\n    const handleScale = () => {\n      if (!avatarChildrenRef.current || !avatarRef.current) {\n        return;\n      }\n      const childrenWidth = avatarChildrenRef.current.offsetWidth;\n      const avatarWidth = avatarRef.current.offsetWidth;\n\n      if (childrenWidth !== 0 && avatarWidth !== 0) {\n        if (gap * 2 < avatarWidth) {\n          setScale(avatarWidth - gap * 2 < childrenWidth ? (avatarWidth - gap * 2) / childrenWidth : 1);\n        }\n      }\n    };\n    const { ref: observerRef } = useResizeObserver<HTMLDivElement>({\n      onResize: handleScale,\n    });\n\n    const handleImgLoadError = () => {\n      onError && onError();\n      !hideOnLoadFailed && setIsImgExist(false);\n    };\n\n    useEffect(() => {\n      setIsImgExist(true);\n      setScale(1);\n    }, [props.image]);\n\n    useEffect(() => {\n      handleScale();\n    }, []);\n\n    const { SIZE } = useCommonClassName();\n    const numSizeStyle: React.CSSProperties =\n      size && !SIZE[size]\n        ? {\n            width: size,\n            height: size,\n            fontSize: `${Number.parseInt(size, 10) / 2}px`,\n          }\n        : {};\n    const imageStyle: React.CSSProperties =\n      size && !SIZE[size]\n        ? {\n            width: size,\n            height: size,\n          }\n        : {};\n\n    const preClass = `${classPrefix}-avatar`;\n\n    const avatarClass = classNames(preClass, className, {\n      [SIZE[size]]: !!SIZE[size],\n      [`${preClass}--${shape}`]: !!shape,\n      [`${preClass}-icon`]: !!icon,\n    });\n\n    let content;\n    if (image && isImgExist) {\n      content = <img src={image} alt={alt} style={imageStyle} onError={handleImgLoadError} />;\n    } else if (icon) {\n      content = icon;\n    } else {\n      const childrenStyle: React.CSSProperties = {\n        transform: `scale(${scale})`,\n      };\n      content = (\n        <span ref={composeRefs(ref, avatarChildrenRef, observerRef) as any} style={childrenStyle}>\n          {children}\n        </span>\n      );\n    }\n    return (\n      <div\n        ref={composeRefs(ref, avatarRef) as any}\n        className={avatarClass}\n        style={{ ...numSizeStyle, ...style }}\n        {...avatarProps}\n      >\n        {content}\n      </div>\n    );\n  },\n  { Group: AvatarGroup },\n);\n\nAvatar.displayName = 'Avatar';\n\nexport default Avatar;\n"],"names":["Group","props","useConfig","classPrefix","preClass","className","cascading","collapseAvatar","max","placement","popupProps","size","children","avatarGroupProps","childrenList","React","Children","toArray","allChildrenList","length","map","child","index","cloneElement","key","groupClass","classNames","childrenCount","showList","slice","hiddenList","popupNum","popupMergeProps","popupNodes","createElement","Popup","Avatar","content","trigger","showArrow","push","AvatarContextProvider","forwardRefWithStatics","ref","alt","hideOnLoadFailed","icon","image","shape","avatarSize","onError","style","avatarProps","groupSize","useContext","AvatarContext","useState","scale","setScale","isImgExist","setIsImgExist","avatarRef","useRef","avatarChildrenRef","gap","handleScale","current","childrenWidth","offsetWidth","avatarWidth","useResizeObserver","onResize","observerRef","handleImgLoadError","useEffect","useCommonClassName","SIZE","numSizeStyle","width","height","fontSize","Number","parseInt","imageStyle","avatarClass","src","childrenStyle","transform","composeRefs","AvatarGroup","displayName"],"mappings":"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"}