{"version":3,"file":"Option.js","sources":["../../../src/select/base/Option.tsx"],"sourcesContent":["import React, { useRef } from 'react';\nimport classNames from 'classnames';\nimport isNumber from 'lodash/isNumber';\nimport isString from 'lodash/isString';\nimport get from 'lodash/get';\n\nimport useConfig from '../../_util/useConfig';\nimport useRipple from '../../_util/useRipple';\nimport { StyledProps } from '../../common';\nimport { SelectValue, TdOptionProps, TdSelectProps, SelectKeysType } from '../type';\n\n/**\n * Option 组件属性\n */\nexport interface SelectOptionProps\n  extends StyledProps,\n    TdOptionProps,\n    Pick<TdSelectProps, 'size' | 'multiple' | 'max'> {\n  selectedValue?: SelectValue;\n  children?: React.ReactNode;\n  onSelect?: (\n    value: string | number,\n    context: { label?: string; selected?: boolean; event: React.MouseEvent; restData?: Record<string, any> },\n  ) => void;\n  restData?: Record<string, any>;\n  keys?: SelectKeysType;\n}\n\nconst componentType = 'select';\n\nconst Option = (props: SelectOptionProps) => {\n  const {\n    disabled: propDisabled,\n    label: propLabel,\n    selectedValue,\n    multiple,\n    size,\n    max,\n    keys,\n    value,\n    onSelect,\n    children,\n    restData,\n  } = props;\n\n  let selected: boolean;\n  const label = propLabel || value;\n  const disabled = propDisabled || (multiple && Array.isArray(selectedValue) && max && selectedValue.length >= max);\n\n  const { classPrefix } = useConfig();\n  const optionRef = useRef();\n  // 使用斜八角动画\n  useRipple(optionRef);\n\n  // 处理单选场景\n  if (!multiple) {\n    selected =\n      isNumber(selectedValue) || isString(selectedValue)\n        ? value === selectedValue\n        : value === get(selectedValue, keys?.value || 'value');\n  }\n\n  // 处理多选场景\n  if (multiple && Array.isArray(selectedValue)) {\n    selected = selectedValue.some((item) => {\n      if (isNumber(item) || isString(item)) {\n        // 如果非object类型\n        return item === value;\n      }\n      return get(item, keys?.value || 'value') === value;\n    });\n  }\n\n  const handleSelect = (event: React.MouseEvent) => {\n    if (!disabled || (multiple && selected)) {\n      onSelect(value, { label: String(label), selected, event, restData });\n    }\n  };\n\n  const renderItem = (children: React.ReactNode) => {\n    if (multiple) {\n      return (\n        <label\n          className={classNames(`${classPrefix}-checkbox`, {\n            [`${classPrefix}-is-disabled`]: disabled && !selected,\n            [`${classPrefix}-is-checked`]: selected,\n          })}\n        >\n          <input\n            type=\"checkbox\"\n            className={classNames(`${classPrefix}-checkbox__former`)}\n            value=\"\"\n            disabled={disabled && !selected}\n            onClick={(e) => e.stopPropagation()}\n          />\n          <span className={classNames(`${classPrefix}-checkbox__input`)}></span>\n          <span className={classNames(`${classPrefix}-checkbox__label`)}>{children || label}</span>\n        </label>\n      );\n    }\n    return <span>{children || label}</span>;\n  };\n\n  return (\n    <li\n      className={classNames(props.className, `${classPrefix}-${componentType}-option`, {\n        [`${classPrefix}-is-disabled`]: disabled,\n        [`${classPrefix}-is-selected`]: selected,\n        [`${classPrefix}-size-s`]: size === 'small',\n        [`${classPrefix}-size-l`]: size === 'large',\n      })}\n      key={value}\n      onClick={handleSelect}\n      ref={optionRef}\n    >\n      {renderItem(children)}\n    </li>\n  );\n};\n\nexport default Option;\n"],"names":["componentType","Option","props","propDisabled","disabled","propLabel","label","selectedValue","multiple","size","max","keys","value","onSelect","children","restData","selected","Array","isArray","length","useConfig","classPrefix","optionRef","useRef","useRipple","isNumber","isString","get","some","item","handleSelect","event","String","renderItem","children2","React","createElement","className","classNames","type","onClick","e","stopPropagation","key","ref"],"mappings":"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"}