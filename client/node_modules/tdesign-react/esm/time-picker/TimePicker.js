/**
 * tdesign v0.22.1
 * (c) 2022 tdesign
 * @license MIT
 */

import { _ as _defineProperty } from '../_chunks/dep-9332bbea.js';
import { _ as _slicedToArray } from '../_chunks/dep-93971e86.js';
import React, { useState } from 'react';
import dayjs from 'dayjs';
import classNames from 'classnames';
import { c as commonjsGlobal } from '../_chunks/dep-ab1e2688.js';
import { TimeIcon } from 'tdesign-icons-react';
import forwardRefWithStatics from '../_util/forwardRefWithStatics.js';
import useDefaultValue from '../_util/useDefaultValue.js';
import useConfig from '../_util/useConfig.js';
import noop from '../_util/noop.js';
import { Popup } from '../popup/index.js';
import { Input } from '../input/index.js';
import TimeRangePicker from './TimeRangePicker.js';
import TimePickerPanel from './panel/TimePickerPanel.js';
import TimePickerInputItems from './InputItems.js';
import { useTimePickerTextConfig, DEFAULT_FORMAT, DEFAULT_STEPS } from './consts.js';
import '../_chunks/dep-beac373a.js';
import 'hoist-non-react-statics';
import '../_chunks/dep-27d690ce.js';
import '../_util/useDefault.js';
import '../config-provider/ConfigContext.js';
import '../locale/zh_CN.js';
import '../popup/Popup.js';
import 'react-transition-group';
import 'react-popper';
import '../_util/composeRefs.js';
import '../_util/usePrevious.js';
import '../popup/Portal.js';
import 'react-dom';
import '../popup/hooks/useTriggerProps.js';
import '../_util/useClickOutside.js';
import '../popup/hooks/usePopupCssTransition.js';
import '../popup/style/index.js';
import '../popup/type.js';
import '../input/Input.js';
import '../_chunks/dep-25536592.js';
import '../_chunks/dep-aa2bff1b.js';
import '../_chunks/dep-156c830d.js';
import '../_chunks/dep-a764e3bd.js';
import '../_chunks/dep-d098d908.js';
import '../input/InputGroup.js';
import '../input/style/index.js';
import '../input/type.js';
import './panel/TimePickerRangePanel.js';
import './panel/SinglePanel.js';
import '../_chunks/dep-9e88086c.js';
import '../_chunks/dep-cac5f189.js';
import '../_chunks/dep-95c9ff5b.js';
import '../_chunks/dep-312619d6.js';
import '../_chunks/dep-8dc257e5.js';
import '../_chunks/dep-44c00646.js';
import '../_chunks/dep-897ce04d.js';
import '../_chunks/dep-2eff142e.js';
import '../_chunks/dep-304ab091.js';
import '../_chunks/dep-ea69dcf8.js';
import '../_chunks/dep-8bccb9b0.js';
import '../_chunks/dep-028895a6.js';
import '../_chunks/dep-6bae5139.js';
import '../_chunks/dep-0de37580.js';
import '../_chunks/dep-b8263a1c.js';
import '../_chunks/dep-8309e373.js';
import '../_chunks/dep-14692160.js';
import '../_chunks/dep-f88db21e.js';
import './interfaces.js';
import '../button/index.js';
import '../button/Button.js';
import '../_util/useRipple.js';
import '../_util/setStyle.js';
import '../loading/index.js';
import '../loading/loading.js';
import '../_util/dom.js';
import 'raf';
import '../_chunks/dep-3853103d.js';
import '../_util/easing.js';
import '../common/Portal.js';
import '../loading/gradient.js';
import '../loading/style/index.js';
import '../loading/type.js';
import '../loading/plugin.js';
import '../button/style/index.js';
import '../button/type.js';
import '../_chunks/dep-124f91c5.js';
import '../locale/LocalReceiver.js';
import '../config-provider/index.js';
import '../config-provider/ConfigProvider.js';

var customParseFormat$1 = {exports: {}};

(function (module, exports) {
  !function (t, e) {
    "object" == 'object' && "undefined" != 'object' ? module.exports = e() : "function" == typeof undefined && undefined.amd ? undefined(e) : t.dayjs_plugin_customParseFormat = e();
  }(commonjsGlobal, function () {
    "use strict";

    var t,
        e = {
      LTS: "h:mm:ss A",
      LT: "h:mm A",
      L: "MM/DD/YYYY",
      LL: "MMMM D, YYYY",
      LLL: "MMMM D, YYYY h:mm A",
      LLLL: "dddd, MMMM D, YYYY h:mm A"
    },
        n = function n(t, _n) {
      return t.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g, function (t, r, i) {
        var o = i && i.toUpperCase();
        return r || _n[i] || e[i] || _n[o].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g, function (t, e, n) {
          return e || n.slice(1);
        });
      });
    },
        r = /(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,
        i = /\d\d/,
        o = /\d\d?/,
        s = /\d*[^\s\d-:/()]+/;

    var a = function a(t) {
      return function (e) {
        this[t] = +e;
      };
    },
        f = [/[+-]\d\d:?(\d\d)?/, function (t) {
      (this.zone || (this.zone = {})).offset = function (t) {
        if (!t) return 0;
        var e = t.match(/([+-]|\d\d)/g),
            n = 60 * e[1] + (+e[2] || 0);
        return 0 === n ? 0 : "+" === e[0] ? -n : n;
      }(t);
    }],
        u = function u(e) {
      var n = t[e];
      return n && (n.indexOf ? n : n.s.concat(n.f));
    },
        h = function h(e, n) {
      var r,
          i = t.meridiem;

      if (i) {
        for (var o = 1; o <= 24; o += 1) {
          if (e.indexOf(i(o, 0, n)) > -1) {
            r = o > 12;
            break;
          }
        }
      } else r = e === (n ? "pm" : "PM");

      return r;
    },
        d = {
      A: [s, function (t) {
        this.afternoon = h(t, !1);
      }],
      a: [s, function (t) {
        this.afternoon = h(t, !0);
      }],
      S: [/\d/, function (t) {
        this.milliseconds = 100 * +t;
      }],
      SS: [i, function (t) {
        this.milliseconds = 10 * +t;
      }],
      SSS: [/\d{3}/, function (t) {
        this.milliseconds = +t;
      }],
      s: [o, a("seconds")],
      ss: [o, a("seconds")],
      m: [o, a("minutes")],
      mm: [o, a("minutes")],
      H: [o, a("hours")],
      h: [o, a("hours")],
      HH: [o, a("hours")],
      hh: [o, a("hours")],
      D: [o, a("day")],
      DD: [i, a("day")],
      Do: [s, function (e) {
        var n = t.ordinal,
            r = e.match(/\d+/);
        if (this.day = r[0], n) for (var i = 1; i <= 31; i += 1) {
          n(i).replace(/\[|\]/g, "") === e && (this.day = i);
        }
      }],
      M: [o, a("month")],
      MM: [i, a("month")],
      MMM: [s, function (t) {
        var e = u("months"),
            n = (u("monthsShort") || e.map(function (t) {
          return t.substr(0, 3);
        })).indexOf(t) + 1;
        if (n < 1) throw new Error();
        this.month = n % 12 || n;
      }],
      MMMM: [s, function (t) {
        var e = u("months").indexOf(t) + 1;
        if (e < 1) throw new Error();
        this.month = e % 12 || e;
      }],
      Y: [/[+-]?\d+/, a("year")],
      YY: [i, function (t) {
        t = +t, this.year = t + (t > 68 ? 1900 : 2e3);
      }],
      YYYY: [/\d{4}/, a("year")],
      Z: f,
      ZZ: f
    };

    var c = function c(e, i, o) {
      try {
        var s = function (e) {
          for (var i = (e = n(e, t && t.formats)).match(r), o = i.length, s = 0; s < o; s += 1) {
            var a = i[s],
                f = d[a],
                u = f && f[0],
                h = f && f[1];
            i[s] = h ? {
              regex: u,
              parser: h
            } : a.replace(/^\[|\]$/g, "");
          }

          return function (t) {
            for (var e = {}, n = 0, r = 0; n < o; n += 1) {
              var s = i[n];
              if ("string" == typeof s) r += s.length;else {
                var a = s.regex,
                    f = s.parser,
                    u = t.substr(r),
                    h = a.exec(u)[0];
                f.call(e, h), t = t.replace(h, "");
              }
            }

            return function (t) {
              var e = t.afternoon;

              if (void 0 !== e) {
                var n = t.hours;
                e ? n < 12 && (t.hours += 12) : 12 === n && (t.hours = 0), delete t.afternoon;
              }
            }(e), e;
          };
        }(i)(e),
            a = s.year,
            f = s.month,
            u = s.day,
            h = s.hours,
            c = s.minutes,
            m = s.seconds,
            l = s.milliseconds,
            M = s.zone,
            Y = new Date(),
            v = u || (a || f ? 1 : Y.getDate()),
            p = a || Y.getFullYear(),
            D = 0;

        a && !f || (D = f > 0 ? f - 1 : Y.getMonth());
        var y = h || 0,
            L = c || 0,
            g = m || 0,
            $ = l || 0;
        return M ? new Date(Date.UTC(p, D, v, y, L, g, $ + 60 * M.offset * 1e3)) : o ? new Date(Date.UTC(p, D, v, y, L, g, $)) : new Date(p, D, v, y, L, g, $);
      } catch (t) {
        return new Date("");
      }
    };

    return function (e, n, r) {
      r.p.customParseFormat = !0;
      var i = n.prototype,
          o = i.parse;

      i.parse = function (e) {
        var n = e.date,
            i = e.utc,
            s = e.args;
        this.$u = i;
        var a = s[1];

        if ("string" == typeof a) {
          var f = !0 === s[2],
              u = !0 === s[3],
              h = f || u,
              d = s[2];
          u && (d = s[2]), f || (t = d ? r.Ls[d] : this.$locale()), this.$d = c(n, a, i), this.init(), d && !0 !== d && (this.$L = this.locale(d).$L), h && n !== this.format(a) && (this.$d = new Date("")), t = void 0;
        } else if (a instanceof Array) for (var m = a.length, l = 1; l <= m; l += 1) {
          s[1] = a[l - 1];
          var M = r.apply(this, s);

          if (M.isValid()) {
            this.$d = M.$d, this.$L = M.$L, this.init();
            break;
          }

          l === m && (this.$d = new Date(""));
        } else o.call(this, e);
      };
    };
  });
})(customParseFormat$1, customParseFormat$1.exports);

var customParseFormat = customParseFormat$1.exports;

dayjs.extend(customParseFormat);
var TimePicker = forwardRefWithStatics(function (props, ref) {
  var _classNames;

  var TEXT_CONFIG = useTimePickerTextConfig();

  var _useDefaultValue = useDefaultValue(props),
      allowInput = _useDefaultValue.allowInput,
      className = _useDefaultValue.className,
      clearable = _useDefaultValue.clearable,
      disabled = _useDefaultValue.disabled,
      _useDefaultValue$form = _useDefaultValue.format,
      format = _useDefaultValue$form === void 0 ? DEFAULT_FORMAT : _useDefaultValue$form,
      _useDefaultValue$hide = _useDefaultValue.hideDisabledTime,
      hideDisabledTime = _useDefaultValue$hide === void 0 ? true : _useDefaultValue$hide,
      _useDefaultValue$plac = _useDefaultValue.placeholder,
      placeholder = _useDefaultValue$plac === void 0 ? TEXT_CONFIG.placeholder : _useDefaultValue$plac,
      style = _useDefaultValue.style,
      _useDefaultValue$size = _useDefaultValue.size,
      size = _useDefaultValue$size === void 0 ? "medium" : _useDefaultValue$size,
      _useDefaultValue$step = _useDefaultValue.steps,
      steps = _useDefaultValue$step === void 0 ? DEFAULT_STEPS : _useDefaultValue$step,
      value = _useDefaultValue.value,
      disableTime = _useDefaultValue.disableTime,
      _useDefaultValue$onBl = _useDefaultValue.onBlur,
      onBlur = _useDefaultValue$onBl === void 0 ? noop : _useDefaultValue$onBl,
      onChange = _useDefaultValue.onChange,
      _useDefaultValue$onCl = _useDefaultValue.onClose,
      onClose = _useDefaultValue$onCl === void 0 ? noop : _useDefaultValue$onCl,
      _useDefaultValue$onFo = _useDefaultValue.onFocus,
      onFocus = _useDefaultValue$onFo === void 0 ? noop : _useDefaultValue$onFo,
      _useDefaultValue$onIn = _useDefaultValue.onInput,
      onInput = _useDefaultValue$onIn === void 0 ? noop : _useDefaultValue$onIn,
      _useDefaultValue$onOp = _useDefaultValue.onOpen,
      onOpen = _useDefaultValue$onOp === void 0 ? noop : _useDefaultValue$onOp;

  var _useState = useState(false),
      _useState2 = _slicedToArray(_useState, 2),
      isPanelShowed = _useState2[0],
      setPanelShow = _useState2[1];

  var _useConfig = useConfig(),
      classPrefix = _useConfig.classPrefix;

  var name = "".concat(classPrefix, "-time-picker");
  var inputClasses = classNames("".concat(name, "__group"), (_classNames = {}, _defineProperty(_classNames, "".concat(classPrefix, "-is-focused"), isPanelShowed), _defineProperty(_classNames, "".concat(classPrefix, "-input--focused"), isPanelShowed), _classNames));

  var handleShowPopup = function handleShowPopup(visible, context) {
    setPanelShow(visible);
    visible ? onOpen(context) : onClose(context);
  };

  var handleClear = function handleClear(context) {
    var e = context.e;
    e.stopPropagation();
    onChange(null);
  };

  return /* @__PURE__ */React.createElement(Popup, {
    content: /* @__PURE__ */React.createElement(TimePickerPanel, {
      steps: steps,
      format: format,
      disableTime: disableTime,
      hideDisabledTime: hideDisabledTime,
      isFooterDisplay: true,
      onChange: onChange,
      handleConfirmClick: function handleConfirmClick(value2) {
        onChange(dayjs(value2).format(format));
        setPanelShow(false);
      },
      value: value
    }),
    disabled: disabled,
    visible: isPanelShowed,
    onVisibleChange: handleShowPopup,
    overlayClassName: classNames("".concat(name, "__panel-container")),
    placement: "bottom-left",
    trigger: "click",
    expandAnimation: true
  }, /* @__PURE__ */React.createElement("div", {
    className: classNames(name, className),
    ref: ref,
    style: style
  }, /* @__PURE__ */React.createElement(Input, {
    readonly: true,
    disabled: disabled,
    size: size,
    clearable: clearable,
    value: value ? " " : void 0,
    onClear: handleClear,
    placeholder: !value ? placeholder : void 0,
    className: inputClasses,
    suffixIcon: /* @__PURE__ */React.createElement(TimeIcon, null)
  }), value ? /* @__PURE__ */React.createElement(TimePickerInputItems, {
    disabled: disabled,
    format: format,
    allowInput: allowInput,
    value: [value],
    onBlur: onBlur,
    onFocus: onFocus,
    onInput: onInput,
    onChange: onChange
  }) : null));
}, {
  displayName: "TimePicker",
  TimeRangePicker: TimeRangePicker
});

export { TimePicker as default };
//# sourceMappingURL=TimePicker.js.map
