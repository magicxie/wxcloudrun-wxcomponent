{"version":3,"file":"TransferList.js","sources":["../../src/transfer/TransferList.tsx"],"sourcesContent":["import React, { useMemo, useState } from 'react';\nimport classnames from 'classnames';\nimport isFunction from 'lodash/isFunction';\nimport isEmpty from 'lodash/isEmpty';\nimport isString from 'lodash/isString';\nimport { SearchIcon } from 'tdesign-icons-react';\nimport useConfig from '../_util/useConfig';\nimport { TdTransferProps, TransferValue } from './type';\nimport { TNode, StyledProps } from '../common';\nimport Checkbox from '../checkbox';\nimport Input from '../input';\nimport Pagination, { PaginationProps } from '../pagination';\n\ninterface TransferListProps extends Pick<TdTransferProps, 'data' | 'search' | 'checked' | 'transferItem'>, StyledProps {\n  disabled?: boolean;\n  empty?: TNode | string;\n  title?: TNode;\n  footer?: TNode;\n  content?: TNode;\n  pagination?: Pick<PaginationProps, 'pageSize'> & { onPageChange?: (current: number) => void };\n  onCheckbox?: (checked: Array<TransferValue>) => void;\n  onSearch?: (value: string) => void;\n}\n\nconst TransferList: React.FunctionComponent<TransferListProps> = (props) => {\n  const {\n    className,\n    style,\n    data,\n    search = false,\n    checked = [],\n    empty,\n    title,\n    footer,\n    content,\n    onCheckbox,\n    onSearch,\n    disabled = false,\n    pagination,\n    transferItem,\n  } = props;\n\n  const notDisabledData = data.filter((item) => !item.disabled);\n  const [currentPage, setCurrentPage] = useState<number>(1);\n\n  const [indeterminate, allChecked] = useMemo(() => {\n    const aciveLen = checked.length;\n    const notLen = notDisabledData.length;\n    return [aciveLen && aciveLen < notLen, aciveLen && aciveLen === notLen];\n  }, [checked, notDisabledData]);\n\n  const { classPrefix } = useConfig();\n  const CLASSPREFIX = `${classPrefix}-transfer__list`;\n\n  const handleCheckbox = (vals: Array<TransferValue>) => {\n    if (isFunction(onCheckbox)) onCheckbox(vals);\n  };\n\n  const handleAllCheckbox = (checked: boolean) => {\n    if (isFunction(onCheckbox)) onCheckbox(checked ? notDisabledData.map((item) => item.value) : []);\n  };\n\n  const HeaderCmp = () => (\n    <div className={`${CLASSPREFIX}-header`}>\n      <div>\n        <Checkbox\n          indeterminate={indeterminate}\n          checked={allChecked}\n          disabled={disabled}\n          onChange={handleAllCheckbox}\n        ></Checkbox>\n        <span>\n          {checked.length} / {data.length} 项\n        </span>\n      </div>\n      <span>{title}</span>\n    </div>\n  );\n\n  const SearchCmp = () =>\n    search ? (\n      <div className={`${classPrefix}-transfer__search-wrapper`}>\n        <Input placeholder=\"请输入关键词搜索\" suffixIcon={<SearchIcon></SearchIcon>} onChange={onSearch}></Input>\n      </div>\n    ) : null;\n\n  const viewData = useMemo(() => {\n    if (!isEmpty(pagination)) {\n      const pageSize = pagination.pageSize || 10;\n      const start = (currentPage - 1) * pageSize;\n      return data.slice(start, start + pageSize);\n    }\n    return data;\n  }, [currentPage, data, pagination]);\n\n  const EmptyCmp = () =>\n    isString(empty) ? (\n      <div className={`${classPrefix}-transfer__empty`}>\n        <span>{empty || '暂无数据'}</span>\n      </div>\n    ) : (\n      empty\n    );\n\n  const contentCmp = () => {\n    if (typeof content === 'function') {\n      return content({ data: viewData });\n    }\n    return (\n      <Checkbox.Group value={checked} onChange={handleCheckbox} disabled={disabled}>\n        {viewData.map((item, index) => (\n          <Checkbox key={item.value} value={item.value} disabled={item.disabled} className={`${CLASSPREFIX}-item`}>\n            <span>\n              {typeof transferItem === 'function' ? transferItem({ data: item, index, type: 'source' }) : item.label}\n            </span>\n          </Checkbox>\n        ))}\n      </Checkbox.Group>\n    );\n  };\n  const BodyCmp = () => (\n    <div\n      className={classnames(`${CLASSPREFIX}-body`, {\n        [`${CLASSPREFIX}--with-search`]: search,\n      })}\n    >\n      {SearchCmp()}\n      <div className={`${CLASSPREFIX}-content narrow-scrollbar`}>{viewData.length ? contentCmp() : EmptyCmp()}</div>\n    </div>\n  );\n\n  const PaginationCmp = () => {\n    const handleCurrentPagination = (current: number) => {\n      setCurrentPage(current);\n      if (isFunction(pagination.onPageChange)) {\n        pagination.onPageChange(current);\n      }\n    };\n\n    return pagination ? (\n      <div className={`${CLASSPREFIX}-pagination`}>\n        <Pagination\n          size=\"small\"\n          theme=\"simple\"\n          pageSizeOptions={[]}\n          total={data.length}\n          totalContent={false}\n          onCurrentChange={handleCurrentPagination}\n          pageSize={pagination.pageSize}\n        />\n      </div>\n    ) : null;\n  };\n\n  const footerCmp = () => (!isEmpty(footer) ? <div className={`${classPrefix}-transfer__footer`}>{footer}</div> : null);\n\n  return (\n    <div style={style} className={classnames(CLASSPREFIX, className)}>\n      {HeaderCmp()}\n      {BodyCmp()}\n      {PaginationCmp()}\n      {footerCmp()}\n    </div>\n  );\n};\n\nexport default TransferList;\n"],"names":["TransferList","props","className","style","data","search","checked","empty","title","footer","content","onCheckbox","onSearch","disabled","pagination","transferItem","notDisabledData","filter","item","useState","currentPage","setCurrentPage","useMemo","aciveLen","length","notLen","indeterminate","allChecked","useConfig","classPrefix","CLASSPREFIX","handleCheckbox","vals","isFunction","handleAllCheckbox","checked2","map","value","HeaderCmp","React","createElement","Checkbox","onChange","SearchCmp","Input","placeholder","suffixIcon","SearchIcon","viewData","isEmpty","pageSize","start","slice","EmptyCmp","isString","contentCmp","Group","index","key","type","label","BodyCmp","classnames","PaginationCmp","handleCurrentPagination","current","onPageChange","Pagination","size","theme","pageSizeOptions","total","totalContent","onCurrentChange","footerCmp"],"mappings":"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"}