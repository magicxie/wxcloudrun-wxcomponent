{"version":3,"file":"Pagination.js","sources":["../../src/pagination/Pagination.tsx"],"sourcesContent":["import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport classNames from 'classnames';\nimport {\n  ChevronLeftIcon,\n  EllipsisIcon,\n  ChevronLeftDoubleIcon,\n  ChevronRightIcon,\n  ChevronRightDoubleIcon,\n} from 'tdesign-icons-react';\nimport noop from '../_util/noop';\nimport useConfig from '../_util/useConfig';\nimport useDefault from '../_util/useDefault';\nimport Select from '../select';\nimport InputNumber from '../input-number';\nimport { useLocaleReceiver } from '../locale/LocalReceiver';\n\nimport { TdPaginationProps } from './type';\nimport { StyledProps } from '../common';\nimport { pageSizeValidator } from './validators';\n\nexport type { PageInfo } from './type';\n\nexport interface PaginationProps extends TdPaginationProps, StyledProps {}\n\nconst { Option } = Select;\n\nenum KeyCode {\n  ENTER = 13,\n}\n\nconst Pagination: React.FC<PaginationProps> = (props: PaginationProps) => {\n  const {\n    defaultCurrent = 1,\n    current: currentFromProps,\n    theme = 'default',\n    size = 'medium',\n    total = 0,\n    defaultPageSize = 10,\n    pageSize: pageSizeFromProps,\n    showJumper = false,\n    disabled = false,\n    foldedMaxPageBtn = 5,\n    maxPageBtn = 10,\n    totalContent = true,\n    pageSizeOptions = [5, 10, 20, 50],\n    onChange = noop,\n    onCurrentChange,\n    onPageSizeChange,\n  } = props;\n\n  const [locale, t] = useLocaleReceiver('pagination');\n\n  const [pageSize, setPageSize] = useDefault(pageSizeFromProps, defaultPageSize, onPageSizeChange);\n  const [current, setCurrent] = useDefault(currentFromProps, defaultCurrent, onCurrentChange);\n\n  const [pageCount, setPageCount] = useState(1);\n  const [hoverPreMore, toggleHoverPreMore] = useState(false); // 处理left ellipsis展示逻辑\n  const [hoverNextMore, toggleHoverNextMore] = useState(false); // 处理right ellipsis展示逻辑\n  const simpleInputRef = useRef<HTMLInputElement>(null);\n\n  const min = 1;\n  const pivot = Math.ceil((foldedMaxPageBtn - 1) / 2);\n  const { classPrefix } = useConfig();\n  const name = `${classPrefix}-pagination`; // t-pagination\n\n  useEffect(() => {\n    const calCount = Math.ceil(total / pageSize);\n    setPageCount(calCount > 0 ? calCount : 1);\n  }, [pageSize, total]);\n\n  // 计算pageList的逻辑，用memo避免每次重复计算的消耗\n  const pageList = useMemo<Array<number>>(() => {\n    const isPrevMoreShow = 2 + pivot < current;\n    const isNextMoreShow = pageCount - 1 - pivot > current;\n    const array: Array<number> = [];\n    let start: number;\n    let end: number;\n\n    if (pageCount > maxPageBtn) {\n      if (isPrevMoreShow && isNextMoreShow) {\n        start = current - pivot;\n        end = current + pivot;\n      } else {\n        start = isPrevMoreShow ? pageCount - foldedMaxPageBtn + 1 : 2;\n        end = isPrevMoreShow ? pageCount - 1 : foldedMaxPageBtn;\n      }\n    } else {\n      start = 1;\n      end = pageCount;\n    }\n\n    for (let i = start; i <= end; i++) {\n      array.push(i);\n    }\n    return array;\n  }, [current, pageCount, foldedMaxPageBtn, maxPageBtn, pivot]);\n\n  // 处理改变当前页的逻辑\n  const changeCurrent = (nextCurrent: number, nextPageSize?: number) => {\n    if (!nextPageSize && !pageSizeValidator(nextPageSize)) {\n      // eslint-disable-next-line\n      nextPageSize =\n        pageSize ?? (typeof pageSizeOptions[0] === 'number' ? pageSizeOptions[0] : pageSizeOptions[0]?.value);\n    }\n\n    if (disabled) return;\n    if (pageCount < nextCurrent) {\n      setCurrent(pageCount, { current: pageCount, previous: current, pageSize: nextPageSize });\n      return;\n    }\n    if (nextCurrent < min) {\n      setCurrent(min, { current: min, previous: current, pageSize: nextPageSize });\n\n      return;\n    }\n    setCurrent(nextCurrent, { current: nextCurrent, previous: current, pageSize: nextPageSize });\n\n    if (simpleInputRef.current) {\n      simpleInputRef.current.value = String(nextCurrent);\n    }\n    onChange({\n      current: nextCurrent,\n      previous: current,\n      pageSize: nextPageSize,\n    });\n  };\n\n  // 处理改变pageSize的逻辑\n  const changePageSize = (nextPageSize: number) => {\n    const nextCurrent = Math.min(current, Math.ceil(total / nextPageSize));\n    const pageInfo = {\n      current: nextCurrent,\n      previous: current,\n      pageSize: nextPageSize,\n    };\n    setPageSize(nextPageSize, pageInfo);\n\n    // 改变分页大小也需要触发onChange回调 如果改变分页大小会改变currentPage 则由changeCurrent内去触发onChange 否则需要自己触发\n    if (current !== nextCurrent) {\n      changeCurrent(nextCurrent, nextPageSize);\n    } else {\n      onChange(pageInfo);\n    }\n  };\n\n  // 处理极简版的当前页ga的逻辑\n  const onSimpleCurrentChange = (nextCurrent: number) => {\n    if (disabled || pageCount < nextCurrent || nextCurrent < min) return;\n    setCurrent(nextCurrent, { current: nextCurrent, previous: current, pageSize });\n    onChange({\n      current: nextCurrent,\n      previous: current,\n      pageSize,\n    });\n  };\n\n  const onPageInputChange = (value: number) => {\n    setCurrent(value, { current: value, previous: current, pageSize });\n  };\n\n  const onPageInputKeyUp = (value: number, context: { e: React.KeyboardEvent<HTMLDivElement> }) => {\n    const { e } = context;\n    if (e.keyCode !== KeyCode.ENTER) return;\n    changeCurrent(value);\n  };\n\n  // 渲染total相关逻辑\n  const renderTotalContent = () => {\n    if (typeof totalContent === 'boolean') {\n      return totalContent ? t(locale.total, { total }) : null;\n    }\n    if (typeof totalContent === 'string') return totalContent;\n    if (typeof totalContent === 'function') {\n      const start = (current - min) * pageSize;\n      const end = Math.min(total, start + pageSize);\n      return totalContent(total, [start + min, end]);\n    }\n  };\n\n  const isFolded = pageCount > maxPageBtn; // 判断是否为需要折叠\n\n  const renderPaginationBtns = (\n    <>\n      {isFolded && (\n        <>\n          <li\n            key={1}\n            className={classNames(`${name}__number`, {\n              [`${classPrefix}-is-disabled`]: disabled,\n              [`${classPrefix}-is-current`]: current === 1,\n            })}\n            onClick={() => changeCurrent(1)}\n          >\n            1\n          </li>\n          {2 + pivot < current && (\n            <li\n              className={classNames(`${name}__number`, `${name}__number--more`, {\n                [`${classPrefix}-is-disabled`]: disabled,\n              })}\n              onMouseEnter={() => toggleHoverPreMore(true)}\n              onMouseLeave={() => toggleHoverPreMore(false)}\n              onClick={() => changeCurrent(current - foldedMaxPageBtn)}\n            >\n              {!hoverPreMore ? <EllipsisIcon /> : <ChevronLeftDoubleIcon />}\n            </li>\n          )}\n        </>\n      )}\n      {pageList.map((item) => (\n        <li\n          key={item}\n          className={classNames(`${name}__number`, {\n            [`${classPrefix}-is-disabled`]: disabled,\n            [`${classPrefix}-is-current`]: current === item,\n          })}\n          onClick={() => changeCurrent(item)}\n        >\n          {item}\n        </li>\n      ))}\n      {isFolded && (\n        <>\n          {pageCount - 1 - pivot > current && (\n            <li\n              className={classNames(`${name}__number`, `${name}__number--more`, {\n                [`${classPrefix}-is-disabled`]: disabled,\n              })}\n              onMouseEnter={() => toggleHoverNextMore(true)}\n              onMouseLeave={() => toggleHoverNextMore(false)}\n              onClick={() => changeCurrent(current + foldedMaxPageBtn)}\n            >\n              {!hoverNextMore ? <EllipsisIcon /> : <ChevronRightDoubleIcon />}\n            </li>\n          )}\n          <li\n            key={pageCount}\n            className={classNames(`${name}__number`, {\n              [`${classPrefix}-is-disabled`]: disabled,\n              [`${classPrefix}-is-current`]: current === pageCount,\n            })}\n            onClick={() => changeCurrent(pageCount)}\n          >\n            {pageCount}\n          </li>\n        </>\n      )}\n    </>\n  );\n\n  return (\n    <div\n      className={classNames(name, {\n        [`${classPrefix}-size-s`]: size === 'small',\n      })}\n    >\n      {totalContent && <div className={`${name}__total`}>{renderTotalContent()}</div>}\n      {pageSizeOptions instanceof Array && pageSizeOptions.length ? (\n        <div className={`${name}__select`}>\n          <Select size={size} value={pageSize} disabled={disabled} onChange={changePageSize}>\n            {pageSizeOptions.map(\n              // eslint-disable-next-line no-confusing-arrow\n              (item) =>\n                // eslint-disable-next-line implicit-arrow-linebreak\n                typeof item === 'number' ? (\n                  <Option key={item} label={t(locale.itemsPerPage, { size: item })} value={item} />\n                ) : (\n                  <Option key={item.value} label={item.label} value={item.value} />\n                ),\n            )}\n          </Select>\n        </div>\n      ) : null}\n      <div\n        className={classNames(`${name}__btn`, `${name}__btn-prev`, {\n          [`${classPrefix}-is-disabled`]: disabled || current === min,\n        })}\n        onClick={() => changeCurrent(current - 1)}\n      >\n        <ChevronLeftIcon />\n      </div>\n      {theme === 'default' && <ul className={`${name}__pager`}>{renderPaginationBtns}</ul>}\n      {/* 极简版 */}\n      {theme === 'simple' && (\n        <div className={`${name}__select`}>\n          <Select size={size} value={current} disabled={disabled} onChange={onSimpleCurrentChange}>\n            {Array(pageCount)\n              .fill(0)\n              .map((_, i) => i + 1)\n              .map((item) => (\n                <Option key={item} label={`${item}/${pageCount}`} value={item}>\n                  {item}/{pageCount}\n                </Option>\n              ))}\n          </Select>\n        </div>\n      )}\n      <div\n        className={classNames(`${name}__btn`, `${name}__btn-next`, {\n          [`${classPrefix}-is-disabled`]: disabled || current === pageCount,\n        })}\n        onClick={() => changeCurrent(current + 1)}\n      >\n        <ChevronRightIcon />\n      </div>\n      {showJumper && (\n        <div className={`${name}__jump`}>\n          {t(locale.jumpTo)}\n          <InputNumber\n            className={`${classPrefix}-pagination__input`}\n            min={min}\n            theme=\"normal\"\n            max={pageCount}\n            disabled={disabled}\n            onChange={onPageInputChange}\n            onKeyup={onPageInputKeyUp}\n          />\n          {t(locale.page)}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Pagination;\n"],"names":["Option","Select","Pagination","props","defaultCurrent","currentFromProps","current","theme","size","total","defaultPageSize","pageSizeFromProps","pageSize","showJumper","disabled","foldedMaxPageBtn","maxPageBtn","totalContent","pageSizeOptions","onChange","noop","onCurrentChange","onPageSizeChange","useLocaleReceiver","locale","t","useDefault","setPageSize","setCurrent","useState","pageCount","setPageCount","hoverPreMore","toggleHoverPreMore","hoverNextMore","toggleHoverNextMore","simpleInputRef","useRef","min","pivot","Math","ceil","useConfig","classPrefix","name","useEffect","calCount","pageList","useMemo","isPrevMoreShow","isNextMoreShow","array","start","end","i","push","changeCurrent","nextCurrent","nextPageSize","pageSizeValidator","value","previous","String","changePageSize","pageInfo","onSimpleCurrentChange","onPageInputChange","onPageInputKeyUp","context","e","keyCode","renderTotalContent","isFolded","renderPaginationBtns","React","createElement","Fragment","key","className","classNames","onClick","onMouseEnter","onMouseLeave","EllipsisIcon","ChevronLeftDoubleIcon","map","item","ChevronRightDoubleIcon","Array","length","label","itemsPerPage","ChevronLeftIcon","fill","_","ChevronRightIcon","jumpTo","InputNumber","max","onKeyup","page"],"mappings":"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"}