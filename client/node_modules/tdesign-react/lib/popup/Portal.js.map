{"version":3,"file":"Portal.js","sources":["../../src/popup/Portal.tsx"],"sourcesContent":["import React, { useEffect, ReactNode, useMemo } from 'react';\nimport { createPortal } from 'react-dom';\nimport { AttachNode } from '../common';\n\nexport interface PortalProps {\n  // 子元素\n  children: ReactNode;\n\n  // 自定义 container 的方法\n  attach: AttachNode;\n}\n\n// 将 children 渲染到正常的 DOM 树外面\nconst Portal = (props: PortalProps): React.ReactPortal => {\n  const { children, attach } = props;\n\n  const container = useMemo(() => {\n    const el = document.createElement('div');\n    return el;\n  }, []);\n\n  useEffect(() => {\n    let parentElement = document.body;\n    let el = null;\n\n    // 处理 getContainer\n    if (typeof attach === 'function') {\n      el = attach();\n    } else if (typeof attach === 'string') {\n      el = document.querySelector(attach);\n    }\n\n    if (el instanceof HTMLElement) {\n      parentElement = el;\n    }\n\n    parentElement.appendChild(container);\n    return () => {\n      parentElement.removeChild(container);\n    };\n  }, [container, attach]);\n\n  return createPortal(children, container);\n};\n\nexport default Portal;\n"],"names":["Portal","props","children","attach","container","useMemo","el","document","createElement","useEffect","parentElement","body","querySelector","HTMLElement","appendChild","removeChild","createPortal"],"mappings":";;;;;;;;;IAEMA,MAAM,GAAG,SAATA,MAAS,CAACC,KAAD,EAAW;AACxB,MAAQC,QAAR,GAA6BD,KAA7B,CAAQC,QAAR;AAAA,MAAkBC,MAAlB,GAA6BF,KAA7B,CAAkBE,MAAlB;AACA,MAAMC,SAAS,GAAGC,OAAO,CAAC,YAAM;AAC9B,QAAMC,EAAE,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAX;AACA,WAAOF,EAAP;AACD,GAHwB,EAGtB,EAHsB,CAAzB;AAIAG,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIC,aAAa,GAAGH,QAAQ,CAACI,IAA7B;AACA,QAAIL,EAAE,GAAG,IAAT;;AACA,QAAI,OAAOH,MAAP,KAAkB,UAAtB,EAAkC;AAChCG,MAAAA,EAAE,GAAGH,MAAM,EAAX;AACD,KAFD,MAEO,IAAI,OAAOA,MAAP,KAAkB,QAAtB,EAAgC;AACrCG,MAAAA,EAAE,GAAGC,QAAQ,CAACK,aAAT,CAAuBT,MAAvB,CAAL;AACD;;AACD,QAAIG,EAAE,YAAYO,WAAlB,EAA+B;AAC7BH,MAAAA,aAAa,GAAGJ,EAAhB;AACD;;AACDI,IAAAA,aAAa,CAACI,WAAd,CAA0BV,SAA1B;AACA,WAAO,YAAM;AACXM,MAAAA,aAAa,CAACK,WAAd,CAA0BX,SAA1B;AACD,KAFD;AAGD,GAfQ,EAeN,CAACA,SAAD,EAAYD,MAAZ,CAfM,CAAT;AAgBA,sBAAOa,YAAY,CAACd,QAAD,EAAWE,SAAX,CAAnB;AACD;;;;"}