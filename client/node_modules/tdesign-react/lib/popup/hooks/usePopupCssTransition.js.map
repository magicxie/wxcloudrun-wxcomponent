{"version":3,"file":"usePopupCssTransition.js","sources":["../../../src/popup/hooks/usePopupCssTransition.ts"],"sourcesContent":["import { useState } from 'react';\n\ninterface UsePopupCssTransitionParams {\n  contentRef: React.MutableRefObject<HTMLDivElement>;\n  classPrefix: String;\n  expandAnimation: boolean;\n}\n\nconst usePopupCssTransition = ({ contentRef, classPrefix, expandAnimation }: UsePopupCssTransitionParams) => {\n  const [presetMaxHeight, setPresetMaxHeight] = useState<number>(null);\n  const contentEle = contentRef?.current;\n\n  const popupAnimationClassPrefix = `${classPrefix}-popup--animation`;\n\n  const handleEntering = () => {\n    setPresetMaxHeight(parseInt(getComputedStyle(contentEle).maxHeight, 10) || Infinity);\n    if (contentEle) {\n      contentEle.style.overflow = 'hidden';\n      contentEle.style.maxHeight = '0';\n    }\n  };\n\n  const handleEntered = () => {\n    if (contentEle) {\n      const { scrollHeight } = contentEle;\n      const minHeight = presetMaxHeight !== Infinity ? presetMaxHeight : scrollHeight;\n      contentEle.style.maxHeight = `${minHeight}px`;\n      contentEle.style.overflow = '';\n    }\n  };\n\n  const handleExiting = () => {\n    if (contentEle) {\n      contentEle.style.maxHeight = '0';\n      contentEle.style.overflow = 'hidden';\n    }\n  };\n\n  // 不需要扩展动画时，不需要生命周期函数\n  const lifeCircleEvent = expandAnimation\n    ? {\n        onEntering: handleEntering,\n        onEntered: handleEntered,\n        onExiting: handleExiting,\n      }\n    : {};\n\n  return {\n    props: {\n      timeout: 200,\n      nodeRef: contentRef,\n      ...lifeCircleEvent,\n      // 与公共 className 保持一致\n      classNames: {\n        appear: `${popupAnimationClassPrefix}-enter ${popupAnimationClassPrefix}-enter-active`,\n        appearActive: `${popupAnimationClassPrefix}-enter-active`,\n        appearDone: `${popupAnimationClassPrefix}-enter-active ${popupAnimationClassPrefix}-enter-to`,\n        enter: `${popupAnimationClassPrefix}-enter ${popupAnimationClassPrefix}-enter-active`,\n        enterActive: `${popupAnimationClassPrefix}-enter-active`,\n        enterDone: `${popupAnimationClassPrefix}-enter-active ${popupAnimationClassPrefix}-enter-to`,\n        exit: `${popupAnimationClassPrefix}-leave ${popupAnimationClassPrefix}-leave-active`,\n        exitActive: `${popupAnimationClassPrefix}-leave-active`,\n        exitDone: `${popupAnimationClassPrefix}-leave-active ${popupAnimationClassPrefix}-leave-to`,\n      },\n    },\n  };\n};\n\nexport default usePopupCssTransition;\n"],"names":["usePopupCssTransition","contentRef","classPrefix","expandAnimation","useState","presetMaxHeight","setPresetMaxHeight","contentEle","current","popupAnimationClassPrefix","handleEntering","parseInt","getComputedStyle","maxHeight","Infinity","style","overflow","handleEntered","scrollHeight","minHeight","handleExiting","lifeCircleEvent","onEntering","onEntered","onExiting","props","timeout","nodeRef","classNames","appear","appearActive","appearDone","enter","enterActive","enterDone","exit","exitActive","exitDone"],"mappings":";;;;;;;;;;;;;;;IACMA,qBAAqB,GAAG,SAAxBA,qBAAwB,OAAkD;AAAA,MAA/CC,UAA+C,QAA/CA,UAA+C;AAAA,MAAnCC,WAAmC,QAAnCA,WAAmC;AAAA,MAAtBC,eAAsB,QAAtBA,eAAsB;;AAC9E,kBAA8CC,QAAQ,CAAC,IAAD,CAAtD;AAAA;AAAA,MAAOC,eAAP;AAAA,MAAwBC,kBAAxB;;AACA,MAAMC,UAAU,GAAGN,UAAH,aAAGA,UAAH,uBAAGA,UAAU,CAAEO,OAA/B;AACA,MAAMC,yBAAyB,aAAMP,WAAN,sBAA/B;;AACA,MAAMQ,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AAC3BJ,IAAAA,kBAAkB,CAACK,QAAQ,CAACC,gBAAgB,CAACL,UAAD,CAAhB,CAA6BM,SAA9B,EAAyC,EAAzC,CAAR,IAAwDC,QAAzD,CAAlB;;AACA,QAAIP,UAAJ,EAAgB;AACdA,MAAAA,UAAU,CAACQ,KAAX,CAAiBC,QAAjB,GAA4B,QAA5B;AACAT,MAAAA,UAAU,CAACQ,KAAX,CAAiBF,SAAjB,GAA6B,GAA7B;AACD;AACF,GAND;;AAOA,MAAMI,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AAC1B,QAAIV,UAAJ,EAAgB;AACd,UAAQW,YAAR,GAAyBX,UAAzB,CAAQW,YAAR;AACA,UAAMC,SAAS,GAAGd,eAAe,KAAKS,QAApB,GAA+BT,eAA/B,GAAiDa,YAAnE;AACAX,MAAAA,UAAU,CAACQ,KAAX,CAAiBF,SAAjB,aAAgCM,SAAhC;AACAZ,MAAAA,UAAU,CAACQ,KAAX,CAAiBC,QAAjB,GAA4B,EAA5B;AACD;AACF,GAPD;;AAQA,MAAMI,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AAC1B,QAAIb,UAAJ,EAAgB;AACdA,MAAAA,UAAU,CAACQ,KAAX,CAAiBF,SAAjB,GAA6B,GAA7B;AACAN,MAAAA,UAAU,CAACQ,KAAX,CAAiBC,QAAjB,GAA4B,QAA5B;AACD;AACF,GALD;;AAMA,MAAMK,eAAe,GAAGlB,eAAe,GAAG;AACxCmB,IAAAA,UAAU,EAAEZ,cAD4B;AAExCa,IAAAA,SAAS,EAAEN,aAF6B;AAGxCO,IAAAA,SAAS,EAAEJ;AAH6B,GAAH,GAInC,EAJJ;AAKA,SAAO;AACLK,IAAAA,KAAK;AACHC,MAAAA,OAAO,EAAE,GADN;AAEHC,MAAAA,OAAO,EAAE1B;AAFN,OAGAoB,eAHA;AAIHO,MAAAA,UAAU,EAAE;AACVC,QAAAA,MAAM,YAAKpB,yBAAL,oBAAwCA,yBAAxC,kBADI;AAEVqB,QAAAA,YAAY,YAAKrB,yBAAL,kBAFF;AAGVsB,QAAAA,UAAU,YAAKtB,yBAAL,2BAA+CA,yBAA/C,cAHA;AAIVuB,QAAAA,KAAK,YAAKvB,yBAAL,oBAAwCA,yBAAxC,kBAJK;AAKVwB,QAAAA,WAAW,YAAKxB,yBAAL,kBALD;AAMVyB,QAAAA,SAAS,YAAKzB,yBAAL,2BAA+CA,yBAA/C,cANC;AAOV0B,QAAAA,IAAI,YAAK1B,yBAAL,oBAAwCA,yBAAxC,kBAPM;AAQV2B,QAAAA,UAAU,YAAK3B,yBAAL,kBARA;AASV4B,QAAAA,QAAQ,YAAK5B,yBAAL,2BAA+CA,yBAA/C;AATE;AAJT;AADA,GAAP;AAkBD;;;;"}