{"version":3,"file":"TreeSelectInput.js","sources":["../../src/tree-select/TreeSelectInput.tsx"],"sourcesContent":["import React, { useMemo, forwardRef } from 'react';\nimport isEmpty from 'lodash/isEmpty';\nimport isString from 'lodash/isString';\nimport isFunction from 'lodash/isFunction';\nimport { TdTreeSelectProps } from './type';\nimport Input, { InputValue } from '../input';\nimport useConfig from '../_util/useConfig';\n\nexport interface TreeSelectInputProps extends TdTreeSelectProps {\n  visible: boolean;\n  filterText: string;\n  setFilterText: Function;\n  setFocusing: Function;\n  selectedSingle: string;\n}\n\nconst TreeSelectTags = forwardRef((props: TreeSelectInputProps, ref: React.Ref<HTMLInputElement>) => {\n  const {\n    selectedSingle,\n    visible,\n    filterText,\n    setFilterText,\n    setFocusing,\n    placeholder,\n    filter,\n    filterable,\n    multiple,\n    disabled,\n    size,\n    value,\n    onSearch,\n    onBlur,\n    onFocus,\n  } = props;\n  const { classPrefix } = useConfig();\n\n  const showFilter: boolean = useMemo(() => {\n    if (disabled) {\n      return false;\n    }\n    if (!multiple && selectedSingle && (filterable || isFunction(filter))) {\n      return visible;\n    }\n    return filterable || isFunction(filter);\n  }, [disabled, multiple, selectedSingle, filterable, visible, filter]);\n\n  const showPlaceholder: boolean = useMemo(() => {\n    if (\n      !showFilter &&\n      ((isString(value) && value === '' && !selectedSingle) ||\n        (Array.isArray(value) && isEmpty(value)) ||\n        value === null)\n    ) {\n      return true;\n    }\n    return false;\n  }, [showFilter, value, selectedSingle]);\n\n  const filterPlaceholder: string = useMemo(() => {\n    if (multiple && Array.isArray(value) && !isEmpty(value)) {\n      return '';\n    }\n    if (!multiple && selectedSingle) {\n      return selectedSingle;\n    }\n    return placeholder;\n  }, [multiple, value, selectedSingle, placeholder]);\n\n  function handleChange(value) {\n    setFilterText(value);\n    onSearch?.(value);\n  }\n\n  function handleBlur(value: InputValue, context: { e: React.FocusEvent<HTMLDivElement> }) {\n    setFocusing(false);\n    onBlur?.({ value, e: context.e });\n  }\n\n  function handleFocus(value: InputValue, context: { e: React.FocusEvent<HTMLDivElement> }) {\n    setFocusing(true);\n    onFocus?.({ value, e: context.e });\n  }\n\n  const searchInput = showFilter && (\n    <Input\n      ref={ref}\n      value={filterText}\n      className={`${classPrefix}-select__input`}\n      size={size}\n      disabled={disabled}\n      placeholder={filterPlaceholder}\n      onChange={handleChange}\n      onBlur={handleBlur}\n      onFocus={handleFocus}\n    />\n  );\n\n  return (\n    <>\n      {showPlaceholder && <span className={`${classPrefix}-select__placeholder`}>{placeholder}</span>}\n\n      {!multiple && !showPlaceholder && !showFilter && (\n        <span className={`${classPrefix}-select__single`}>{selectedSingle}</span>\n      )}\n\n      {searchInput}\n    </>\n  );\n});\n\nexport default TreeSelectTags;\n"],"names":["TreeSelectTags","forwardRef","props","ref","selectedSingle","visible","filterText","setFilterText","setFocusing","placeholder","filter","filterable","multiple","disabled","size","value","onSearch","onBlur","onFocus","useConfig","classPrefix","showFilter","useMemo","isFunction","showPlaceholder","isString","Array","isArray","isEmpty","filterPlaceholder","handleChange","value2","handleBlur","context","e","handleFocus","searchInput","React","createElement","Input","className","onChange","Fragment"],"mappings":"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"}