{"version":3,"file":"dragger-progress.js","sources":["../../../src/upload/themes/dragger-progress.tsx"],"sourcesContent":["import React, { FC, useCallback } from 'react';\nimport { CheckCircleFilledIcon, ErrorCircleFilledIcon } from 'tdesign-icons-react';\nimport Button from '../../button';\nimport Loading from '../../loading';\nimport useConfig from '../../_util/useConfig';\nimport { UploadFile, UploadRemoveContext } from '../type';\nimport { returnFileSize, abridgeName, getCurrentDate } from '../util';\n\nexport interface DraggerProgressProps {\n  display?: string;\n  file?: UploadFile;\n  onTrigger?: () => void;\n  onRemove?: (context: UploadRemoveContext) => void;\n  onUpload?: () => void;\n}\n\nconst DraggerProgress: FC<DraggerProgressProps> = (props) => {\n  const { file, onUpload, onRemove, display, onTrigger } = props;\n  const { classPrefix } = useConfig();\n\n  const reUpload = (e) => {\n    onRemove?.({ e, file, index: 0 });\n    onTrigger?.();\n  };\n\n  const showResultOperate = React.useMemo(() => ['success', 'fail'].includes(file?.status), [file]);\n\n  const handleRemove = (e) => {\n    onRemove?.({ e, file, index: 0 });\n  };\n\n  const renderUploading = useCallback(() => {\n    if (file?.status === 'fail') {\n      return <ErrorCircleFilledIcon />;\n    }\n    if (file?.status === 'progress') {\n      return (\n        <div className=\"t-upload__single-progress\">\n          <Loading loading={true} size=\"small\" />\n          <span className=\"t-upload__single-percent\">{Math.min(file?.percent || 0, 99)}%</span>\n        </div>\n      );\n    }\n  }, [file]);\n\n  return (\n    <div className={`${classPrefix}-upload__dragger-progress`}>\n      {display === 'image' && (\n        <div className=\"t-upload__dragger-img-wrap\">{file && <img src={file?.url || 'default.png'} alt=\"\" />}</div>\n      )}\n      <div className={`${classPrefix}-upload__dragger-progress-info`}>\n        <div className={`${classPrefix}-upload__dragger-text`}>\n          <span className={`${classPrefix}-upload__single-name`}>{abridgeName(file?.name)}</span>\n          {file?.status !== 'success' && renderUploading()}\n          {file?.status === 'success' && <CheckCircleFilledIcon />}\n        </div>\n        <small className={`${classPrefix}-size-s`}>文件大小：{returnFileSize(file?.size)}</small>\n        <small className={`${classPrefix}-size-s`}>上传日期：{getCurrentDate()}</small>\n        {!['success', 'fail'].includes(file?.status) && (\n          <div className={`${classPrefix}-upload__dragger-btns`}>\n            <Button\n              theme=\"primary\"\n              variant=\"text\"\n              className={`${classPrefix}-upload__dragger-progress-cancel`}\n              onClick={handleRemove}\n            >\n              取消上传\n            </Button>\n            <Button theme=\"primary\" variant=\"text\" onClick={onUpload}>\n              点击上传\n            </Button>\n          </div>\n        )}\n        {showResultOperate && (\n          <div className=\"t-upload__dragger-btns\">\n            <Button theme=\"primary\" variant=\"text\" className=\"t-upload__dragger-progress-cancel\" onClick={reUpload}>\n              重新上传\n            </Button>\n            <Button theme=\"primary\" variant=\"text\" onClick={handleRemove}>\n              删除\n            </Button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default DraggerProgress;\n"],"names":["DraggerProgress","props","file","onUpload","onRemove","display","onTrigger","useConfig","classPrefix","reUpload","e","index","showResultOperate","React","useMemo","includes","status","handleRemove","renderUploading","useCallback","createElement","ErrorCircleFilledIcon","className","Loading","loading","size","Math","min","percent","src","url","alt","abridgeName","name","CheckCircleFilledIcon","returnFileSize","getCurrentDate","Button","theme","variant","onClick"],"mappings":"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"}